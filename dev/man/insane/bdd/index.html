<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Birth-death diffusion · Tapestree.jl</title><meta name="title" content="Birth-death diffusion · Tapestree.jl"/><meta property="og:title" content="Birth-death diffusion · Tapestree.jl"/><meta property="twitter:title" content="Birth-death diffusion · Tapestree.jl"/><meta name="description" content="Documentation for Tapestree.jl."/><meta property="og:description" content="Documentation for Tapestree.jl."/><meta property="twitter:description" content="Documentation for Tapestree.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.png" alt="Tapestree.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.png" alt="Tapestree.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../installation/">Installation</a></li><li><a class="tocitem" href="../../../quick_start/">Quick start</a></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">INSANE</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../contents/">Contents</a></li><li><a class="tocitem" href="../io/">Input and structures</a></li><li><a class="tocitem" href="../cbd/">Constant birth-death</a></li><li class="is-active"><a class="tocitem" href>Birth-death diffusion</a><ul class="internal"><li><a class="tocitem" href="#Pure-birth-diffusion-(\\mu(t)-0)"><span>Pure birth diffusion (<span>$\mu(t) = 0$</span>)</span></a></li><li><a class="tocitem" href="#BDD-process-with-constant-extinction-(\\mu(t)-\\mu)"><span>BDD process with constant extinction (<span>$\mu(t) = \mu$</span>)</span></a></li><li><a class="tocitem" href="#BDD-process-with-constant-turnover-(\\mu(t)-\\epsilon-\\lambda(t))"><span>BDD process with constant turnover (<span>$\mu(t) = \epsilon \lambda(t)$</span>)</span></a></li><li><a class="tocitem" href="#Birth-death-diffusion-process"><span>Birth-death diffusion process</span></a></li><li><a class="tocitem" href="#BDD-process-with-informed-extinction"><span>BDD process with informed extinction</span></a></li></ul></li><li><a class="tocitem" href="../cfbd/">Constant fossilized birth-death</a></li><li><a class="tocitem" href="../fbdd/">Fossilized birth-death diffusion</a></li><li><a class="tocitem" href="../dbm/">Diffused Brownian motion</a></li><li><a class="tocitem" href="../processing/">Processing</a></li><li><a class="tocitem" href="../iplots/">Plotting</a></li></ul></li><li><a class="tocitem" href="../../tribe/">TRIBE</a></li><li><a class="tocitem" href="../../esse/">ESSE</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li><a class="is-disabled">INSANE</a></li><li class="is-active"><a href>Birth-death diffusion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Birth-death diffusion</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl/blob/master/docs/src/man/insane/bdd.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Birth-death-diffusion-(BDD)-processes"><a class="docs-heading-anchor" href="#Birth-death-diffusion-(BDD)-processes">Birth-death diffusion (BDD) processes</a><a id="Birth-death-diffusion-(BDD)-processes-1"></a><a class="docs-heading-anchor-permalink" href="#Birth-death-diffusion-(BDD)-processes" title="Permalink"></a></h1><p>These models all assume that the per-lineage instantaneous speciation rates <span>$\lambda(t)$</span> follow a Geometric Brownian motion (GBM), such that</p><p class="math-container">\[d(\text{ln}(\lambda(t)) = \alpha dt + \sigma_{\lambda} d W(t),\]</p><p>where <span>$\alpha$</span> is the drift, <span>$\sigma_{\lambda}$</span> is the diffusion for speciation, and <span>$W(t)$</span> is the Wiener process (<em>i.e.</em>, standard Brownian motion), and holding different assumptions on extinction.</p><p>The likelihood is approximated using the Euler method to solve Stochastic Differential Equations, and require to set a minimum time step for the discretization of the augmented diffusion paths. In INSANE <code>δt</code> (by default <span>$10^{-3}$</span>) sets the time step to perform the Euler approximation, and denotes the proportion with respect to the tree height (the duration of the tree), so the time step will be <span>$δt = th \times 10^{-3}$</span>, where <span>$th$</span> is the tree height.</p><h2 id="Pure-birth-diffusion-(\\mu(t)-0)"><a class="docs-heading-anchor" href="#Pure-birth-diffusion-(\\mu(t)-0)">Pure birth diffusion (<span>$\mu(t) = 0$</span>)</a><a id="Pure-birth-diffusion-(\\mu(t)-0)-1"></a><a class="docs-heading-anchor-permalink" href="#Pure-birth-diffusion-(\\mu(t)-0)" title="Permalink"></a></h2><p>In the simplest BDD model, the pure-birth diffusion, we assume there is no extinction, that is <span>$\mu(t) = 0$</span>.</p><h3 id="Simulations"><a class="docs-heading-anchor" href="#Simulations">Simulations</a><a id="Simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Simulations" title="Permalink"></a></h3><p>For all the BDD models, we have the possibility to simulate conditioned on total simulation time or the number of species.</p><p>To simulate conditioned on some number of species, say, <span>$20$</span>, with starting speciation rate of <span>$\lambda_0 = 1.0$</span>, drift of <span>$\alpha = 0$</span> and diffusion of <span>$\sigma_{\lambda} = 0.1$</span>, we can use:</p><pre><code class="language-julia hljs"> sim_gbmpb(20, λ0 = 1.0, α = 0.0, σλ = 0.1)</code></pre><p>Similarly, to simulate conditioned on time, say, <span>$10$</span> time units, with the same parameters, we can use:</p><pre><code class="language-julia hljs"> sim_gbmpb(10.0, λ0 = 1.0, α = 0.0, σλ = 0.1)</code></pre><p>Other options are available, such as <code>δt</code> which controls the time step of the simulation, which uses the Euler approximation. Similarly, <code>init</code> can be <code>:crown</code> or <code>:stem</code> to simulate starting with <span>$1$</span> or <span>$2$</span> lineages. </p><div class="admonition is-info" id="Note-1d3c64c02c615726"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-1d3c64c02c615726" title="Permalink"></a></header><div class="admonition-body"><p>The simulations conditioned on time must input a <code>Float64</code> as first (and mandatory) argument while those conditioned on number of species must rater input a <code>Int64</code>.</p></div></div><h3 id="Inference"><a class="docs-heading-anchor" href="#Inference">Inference</a><a id="Inference-1"></a><a class="docs-heading-anchor-permalink" href="#Inference" title="Permalink"></a></h3><p>To perform inference under this model we can use:</p><pre><code class="language-julia hljs">r, tv = insane_gbmpb(tree,
                     nburn    = 1_000,
                     niter    = 50_000,
                     nthin    = 50, 
                     ofile    = &quot;&lt;directory&gt;&quot;,
                     α_prior  = (0.0, 10.0),
                     σλ_prior = (0.05, 0.05),
                     tρ       = Dict(&quot;&quot; =&gt; 1.0))</code></pre><p>Here, the prior for the drift <code>α_prior</code> is a Normal distribution, with the first element representing the mean and the second the standard deviation, and the prior for the diffusion in speciation rates. <code>σλ_prior</code>, is an Inverse Gamma. </p><h2 id="BDD-process-with-constant-extinction-(\\mu(t)-\\mu)"><a class="docs-heading-anchor" href="#BDD-process-with-constant-extinction-(\\mu(t)-\\mu)">BDD process with constant extinction (<span>$\mu(t) = \mu$</span>)</a><a id="BDD-process-with-constant-extinction-(\\mu(t)-\\mu)-1"></a><a class="docs-heading-anchor-permalink" href="#BDD-process-with-constant-extinction-(\\mu(t)-\\mu)" title="Permalink"></a></h2><p>Here we assume that there is extinction, but that is constant across lineages and time.</p><h3 id="Simulations-2"><a class="docs-heading-anchor" href="#Simulations-2">Simulations</a><a class="docs-heading-anchor-permalink" href="#Simulations-2" title="Permalink"></a></h3><p>As with the pure-birth diffusion, we can simulate conditioned on reaching some number of lineages or some time. Now, however, we need to specify the extinction rate as well, for instance to generate a tree with <span>$20$</span> species and some parameter values:</p><pre><code class="language-julia hljs"> sim_gbmce(20, λ0 = 1.0, α = 0.0, σλ = 0.1, μ = 0.7)</code></pre><h3 id="Inference-2"><a class="docs-heading-anchor" href="#Inference-2">Inference</a><a class="docs-heading-anchor-permalink" href="#Inference-2" title="Permalink"></a></h3><p>To perform inference we can use</p><pre><code class="language-julia hljs">r, tv = insane_gbmce(tree,
                     nburn    = 1_000,
                     niter    = 50_000,
                     nthin    = 50, 
                     ofile    = &quot;&lt;directory&gt;&quot;,
                     α_prior  = (0.0, 10.0),
                     σλ_prior = (0.05, 0.05),
                     μ_prior  = (1.0, 1.0),
                     tρ       = Dict(&quot;&quot; =&gt; 1.0))</code></pre><p>where we now specify the Gamma prior <code>μ_prior</code> for the extinction.</p><h2 id="BDD-process-with-constant-turnover-(\\mu(t)-\\epsilon-\\lambda(t))"><a class="docs-heading-anchor" href="#BDD-process-with-constant-turnover-(\\mu(t)-\\epsilon-\\lambda(t))">BDD process with constant turnover (<span>$\mu(t) = \epsilon \lambda(t)$</span>)</a><a id="BDD-process-with-constant-turnover-(\\mu(t)-\\epsilon-\\lambda(t))-1"></a><a class="docs-heading-anchor-permalink" href="#BDD-process-with-constant-turnover-(\\mu(t)-\\epsilon-\\lambda(t))" title="Permalink"></a></h2><p>One can also assume that turnover, <span>$\epsilon$</span>, that is, the ration of extinction over speciation (<em>i.e.</em>, <span>$\frac{\mu}{\lambda}$</span>), is constant.</p><h3 id="Simulations-3"><a class="docs-heading-anchor" href="#Simulations-3">Simulations</a><a class="docs-heading-anchor-permalink" href="#Simulations-3" title="Permalink"></a></h3><p>As with the other BDD models, we can simulate both conditioned on the number of species or in time. For instance, here we condition on time with a turnover rate of <span>$0.4$</span>.</p><pre><code class="language-julia hljs"> sim_gbmct(10.0, λ0 = 1.0, α = 0.0, σλ = 0.1, ϵ = 0.4)</code></pre><h3 id="Inference-3"><a class="docs-heading-anchor" href="#Inference-3">Inference</a><a class="docs-heading-anchor-permalink" href="#Inference-3" title="Permalink"></a></h3><p>Performing inference can then be done using:</p><pre><code class="language-julia hljs">r, tv = insane_gbmct(tree,
                     nburn    = 1_000,
                     niter    = 50_000,
                     nthin    = 50, 
                     ofile    = &quot;&lt;directory&gt;&quot;,
                     α_prior  = (0.0, 10.0),
                     σλ_prior = (0.05, 0.05),
                     ϵ_prior  = (0.0, 100.0),
                     tρ       = Dict(&quot;&quot; =&gt; 1.0))</code></pre><p>where we now specify a Uniform prior <code>ϵ_prior</code> for the turnover. Also, Tapestree resorts to simple MH updates for <span>$\epsilon$</span>, so an increased burnin is recommended. </p><h2 id="Birth-death-diffusion-process"><a class="docs-heading-anchor" href="#Birth-death-diffusion-process">Birth-death diffusion process</a><a id="Birth-death-diffusion-process-1"></a><a class="docs-heading-anchor-permalink" href="#Birth-death-diffusion-process" title="Permalink"></a></h2><p>Finally, we arrive at the most complex model, where extinction also follows a GBM, that is,</p><p class="math-container">\[d(\text{ln}(\mu(t)) = \sigma_{\mu} d W(t),\]</p><p>where <span>$\sigma_{\mu}$</span> is the diffusion for extinction.</p><div class="admonition is-info" id="Note-d0ab8b3f7bf8f3d7"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-d0ab8b3f7bf8f3d7" title="Permalink"></a></header><div class="admonition-body"><p>This is unidentifiable, unless we specify strong priors on the extinction diffusion coefficient <span>$\sigma_{\mu}$</span>, and still do not do well in recovering simulated values, at least for small trees.</p></div></div><h3 id="Simulations-4"><a class="docs-heading-anchor" href="#Simulations-4">Simulations</a><a class="docs-heading-anchor-permalink" href="#Simulations-4" title="Permalink"></a></h3><p>Again, one can specify a time or a number of lineages to simulate under the BDD. For example, for <span>$50$</span> species</p><pre><code class="language-julia hljs"> sim_gbmbd(50, λ0 = 1.0, μ0 = 1.0, α = 0.0, σλ = 0.1, σμ = 0.1)</code></pre><h3 id="Inference-4"><a class="docs-heading-anchor" href="#Inference-4">Inference</a><a class="docs-heading-anchor-permalink" href="#Inference-4" title="Permalink"></a></h3><p>One can perform inference using:</p><pre><code class="language-julia hljs">r, tv = insane_gbmbd(tree,
                     nburn    = 1_000,
                     niter    = 50_000,
                     nthin    = 50, 
                     ofile    = &quot;&lt;directory&gt;&quot;,
                     λ0_prior = (0.05, 148.41),
                     μ0_prior = (0.05, 148.41),
                     α_prior  = (0.0, 10.0),
                     σλ_prior = (0.05, 0.05),
                     σμ_prior = (3.0, 0.1),
                     tρ       = Dict(&quot;&quot; =&gt; 1.0))</code></pre><p>where we have log-normal priors on the initial (root) values for <span>$\lambda_0$</span> and <span>$\mu_0$</span>, and Inverse Gamma prior for sigma. Usually, an informative prior such as <code>σμ_prior = (3.0, 0.1)</code> or more is needed.</p><h2 id="BDD-process-with-informed-extinction"><a class="docs-heading-anchor" href="#BDD-process-with-informed-extinction">BDD process with informed extinction</a><a id="BDD-process-with-informed-extinction-1"></a><a class="docs-heading-anchor-permalink" href="#BDD-process-with-informed-extinction" title="Permalink"></a></h2><p>One can also define a branch-specific fixed extinction function and make inference on the GBM speciation. For example, in Quintero <em>et al.</em> (2024) <em>Science</em>, we estimated extinction rates based on fossil occurrences and then used this as input.</p><h3 id="Inference-5"><a class="docs-heading-anchor" href="#Inference-5">Inference</a><a class="docs-heading-anchor-permalink" href="#Inference-5" title="Permalink"></a></h3><p>To make inference under this model, we need two vectors where each element links to a given branch in the reconstructed tree, in the same order as the phylogenetic tree. Each element of these vectors are themselves a vector of type <code>Float64</code>, and correspond to the time at which extinction is recovered in time backward order (<em>e.g.</em>, [1.1, 1.0, ..., 0.1, 0.08, 0.0]) and to the extinction at those times. INSANE uses a linear approximation function between the input sampled points.</p><p>To make inference under this model, we now input these vectors. Lets call them <code>time_vector</code> (of type <code>Vector{Vector{Float64}}</code>) and <code>extinction_vector</code> (also of type <code>Vector{Vector{Float64}}</code>), then:</p><pre><code class="language-julia hljs">r, tv = insane_gbmbd(tree,
                     time_vector,
                     extinction_vector,
                     nburn    = 1_000,
                     niter    = 50_000,
                     nthin    = 50, 
                     ofile    = &quot;&lt;directory&gt;&quot;,
                     tρ       = Dict(&quot;&quot; =&gt; 1.0))</code></pre><p>The only thing one has to make sure is that the order of <code>time_vector</code> and <code>extinction_vector</code> correspond to the order of the branches in <code>tree</code>, which can be a bit involved. However, this can be achieved by understanding that the trees are recursive and are ordered either by left or right branch, and using some of the tree utility functions. </p><p>For example, one can use the <code>subclade</code> function, to extract a subclade given a set of tip labels. One can also use the <code>make_idf</code> function, which splits the tree into a vector of branches in the same order that INSANE will process the tree. This way one can see the ordering of branches, and then order the <code>time_vector</code> and the <code>extinction_vector</code> in the same order.</p><p>If only one extinction function is used for all the tree, then one has to only create a vector of the time and extinction vector of equal size as the number of branches.</p><p>To estimate the number of branches in your empirical tree (saved in <code>&lt;...tree directory...&gt;</code>), we can do:</p><pre><code class="language-julia hljs"># read tree
tree = read_newick(&quot;&lt;...tree directory...&gt;&quot;)</code></pre><p>Make extinction function vectors for each branch and set a dummy sampling fraction (you can set the real one afterwards! - this is just to estimate the number of branches)</p><pre><code class="language-julia hljs">tρ  = Dict(li =&gt; 1.0 for li in tiplabels(tree))
idf = make_idf(tree, tρ, Inf)

# number of branches
nb = length(idf)</code></pre><p>If we have a global curve with extinction <code>[0.06, 0.02, 0.05]</code> at times <code>[0.5, 0.3, 0.1]</code>, then we would have to create the following input objects for <code>time_vector</code> and <code>extinction_vector</code>:</p><pre><code class="language-julia hljs">extinction_vector = fill([0.06, 0.02, 0.05], nb)
time_vector = fill([0.5, 0.3, 0.1], nb)</code></pre><p>Full documentation</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.sim_gbmpb" href="#Tapestree.INSANE.sim_gbmpb"><code>Tapestree.INSANE.sim_gbmpb</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sim_gbmpb(n       ::Int64;
          λ0      ::Float64 = 1.0,
          α       ::Float64 = 0.0,
          σλ      ::Float64 = 0.1,
          δt      ::Float64 = 1e-3,
          init    ::Symbol  = :stem,
          nstar   ::Int64   = n + 2,
          p       ::Float64 = 5.0,
          warnings::Bool    = true,
          maxt    ::Float64 = δt*1e7)</code></pre><p>Simulate <code>iTpb</code> according to a pure-birth geometric Brownian motion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/sim_gbmpb.jl#L25-L38">source</a></section><section><div><pre><code class="language-julia hljs">sim_gbmpb(t   ::Float64;
          λ0  ::Float64 = 1.0,
          α   ::Float64 = 0.0,
          σλ  ::Float64 = 0.1,
          δt  ::Float64 = 1e-3,
          nlim::Int64   = 10_000,
          init::Symbol  = :crown)</code></pre><p>Simulate <code>iTpb</code> according to a pure-birth geometric Brownian motion conditional in stopping at time <code>t</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/sim_gbmpb.jl#L275-L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.sim_gbmce" href="#Tapestree.INSANE.sim_gbmce"><code>Tapestree.INSANE.sim_gbmce</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sim_gbmce(n       ::Int64;
          λ0      ::Float64 = 1.0,
          α       ::Float64 = 0.0,
          σλ      ::Float64 = 0.1,
          μ       ::Float64 = 0.0,
          δt      ::Float64 = 1e-3,
          init    ::Symbol  = :stem,
          nstar   ::Int64   = 2*n,
          p       ::Float64 = 5.0,
          warnings::Bool    = true,
          maxt    ::Float64 = δt*1e7)</code></pre><p>Simulate <code>iTce</code> according to a geometric Brownian motion for birth rates and constant extinction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/sim_gbmce.jl#L25-L40">source</a></section><section><div><pre><code class="language-julia hljs">sim_gbmce(t   ::Float64;
          λ0  ::Float64 = 1.0,
          α   ::Float64 = 0.0,
          σλ  ::Float64 = 0.1,
          μ   ::Float64 = 0.2,
          δt  ::Float64 = 1e-3,
          nlim::Int64   = 10_000,
          init::Symbol  = :crown)</code></pre><p>Simulate <code>iTce</code> according to a geometric Brownian motion for birth rates and constant extinction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/sim_gbmce.jl#L313-L325">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.sim_gbmct" href="#Tapestree.INSANE.sim_gbmct"><code>Tapestree.INSANE.sim_gbmct</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sim_gbmct(n       ::Int64;
          λ0      ::Float64 = 1.0,
          α       ::Float64 = 0.0,
          σλ      ::Float64 = 0.1,
          ϵ       ::Float64 = 0.0,
          δt      ::Float64 = 1e-3,
          init    ::Symbol  = :stem,
          nstar   ::Int64   = 2*n,
          p       ::Float64 = 5.0,
          warnings::Bool    = true,
          maxt    ::Float64 = δt*1e7)</code></pre><p>Simulate <code>iTct</code> according to a geometric Brownian motion for birth rates and constant turnover.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/sim_gbmct.jl#L26-L41">source</a></section><section><div><pre><code class="language-julia hljs">sim_gbmct(t   ::Float64;
          λ0  ::Float64 = 1.0,
          α   ::Float64 = 0.0,
          σλ  ::Float64 = 0.1,
          ϵ   ::Float64 = 0.2,
          δt  ::Float64 = 1e-3,
          nlim::Int64   = 10_000,
          init::Symbol  = :crown)</code></pre><p>Simulate <code>iTct</code> according to a geometric Brownian motion for birth rates and constant turnover.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/sim_gbmct.jl#L311-L323">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.sim_gbmbd" href="#Tapestree.INSANE.sim_gbmbd"><code>Tapestree.INSANE.sim_gbmbd</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sim_gbmbd(n       ::Int64;
          λ0      ::Float64 = 1.0,
          μ0      ::Float64 = 0.1,
          α       ::Float64 = 0.0,
          σλ      ::Float64 = 0.1,
          σμ      ::Float64 = 0.1,
          init    ::Symbol  = :stem,
          δt      ::Float64 = 1e-3,
          nstar   ::Int64   = 2*n,
          p       ::Float64 = 5.0,
          warnings::Bool    = true)</code></pre><p>Simulate <code>iTbd</code> according to geometric Brownian motions for birth and death rates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/sim_gbmbd.jl#L27-L42">source</a></section><section><div><pre><code class="language-julia hljs">sim_gbmbd(t   ::Float64;
          λ0  ::Float64 = 1.0,
          μ0  ::Float64 = 0.2,
          α   ::Float64 = 0.0,
          σλ  ::Float64 = 0.1,
          σμ  ::Float64 = 0.1,
          δt  ::Float64 = 1e-3,
          nlim::Int64   = 10_000,
          init::Symbol  = :crown)</code></pre><p>Simulate <code>iTbd</code> according to geometric Brownian motions for birth and death rates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/sim_gbmbd.jl#L331-L344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.insane_gbmpb" href="#Tapestree.INSANE.insane_gbmpb"><code>Tapestree.INSANE.insane_gbmpb</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insane_gbmpb(tree    ::sT_label;
             λ0_prior::NTuple{2,Float64}     = (0.05, 148.41),
             α_prior ::NTuple{2,Float64}     = (0.0, 1.0),
             σλ_prior::NTuple{2,Float64}     = (3.0, 0.5),
             niter   ::Int64                 = 1_000,
             nthin   ::Int64                 = 10,
             nburn   ::Int64                 = 200,
             nflush  ::Int64                 = nthin,
             ofile   ::String                = string(homedir(), &quot;/ipb&quot;),
             αi      ::Float64               = 0.0,
             σλi     ::Float64               = 0.1,
             pupdp   ::NTuple{5,Float64}     = (1e-3, 1e-3, 1e-3, 0.2, 0.2),
             δt      ::Float64               = 1e-3,
             prints  ::Int64                 = 5,
             stn     ::Float64               = 0.5,
             tρ      ::Dict{String, Float64} = Dict(&quot;&quot; =&gt; 1.0))</code></pre><p>Run insane for <code>pbd</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/mcmc_gbmpb.jl#L15-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.insane_gbmce" href="#Tapestree.INSANE.insane_gbmce"><code>Tapestree.INSANE.insane_gbmce</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insane_gbmce(tree    ::sT_label;
             λ0_prior::NTuple{2,Float64}     = (0.05, 148.41),
             α_prior ::NTuple{2,Float64}     = (0.0, 1.0),
             σλ_prior::NTuple{2,Float64}     = (3.0, 0.05),
             μ_prior ::NTuple{2,Float64}     = (1.0, 1.0),
             niter   ::Int64                 = 1_000,
             nthin   ::Int64                 = 10,
             nburn   ::Int64                 = 200,
             nflush  ::Int64                 = nthin,
             ofile   ::String                = string(homedir(), &quot;/ice&quot;),
             λi      ::Float64               = NaN,
             αi      ::Float64               = 0.0,
             σλi     ::Float64               = 0.01,
             μi      ::Float64               = NaN,
             ϵi      ::Float64               = 0.2,
             pupdp   ::NTuple{5,Float64}     = (1e-3, 1e-3, 1e-4, 0.1, 0.2),
             δt      ::Float64               = 1e-3,
             prints  ::Int64                 = 5,
             survival::Bool                  = true,
             mxthf   ::Float64               = 0.1,
             tρ      ::Dict{String, Float64} = Dict(&quot;&quot; =&gt; 1.0))</code></pre><p>Run insane for <code>gbm-ce</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/mcmc_gbmce.jl#L15-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.insane_gbmct" href="#Tapestree.INSANE.insane_gbmct"><code>Tapestree.INSANE.insane_gbmct</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insane_gbmct(tree    ::sT_label;
             λ0_prior::NTuple{2,Float64}     = (0.05, 148.41),
             α_prior ::NTuple{2,Float64}     = (0.0, 1.0),
             σλ_prior::NTuple{2,Float64}     = (0.05, 0.05),
             ϵ_prior ::NTuple{2,Float64}     = (0.0, 10.0),
             niter   ::Int64                 = 1_000,
             nthin   ::Int64                 = 10,
             nburn   ::Int64                 = 200,
             nflush  ::Int64                 = nthin,
             ofile   ::String                = string(homedir(), &quot;/ict&quot;),
             tune_int::Int64                 = 100,
             αi      ::Float64               = 0.0,
             λi      ::Float64               = NaN,
             σλi     ::Float64               = 0.01,
             ϵi      ::Float64               = 0.2,
             ϵtni    ::Float64               = 0.1,
             obj_ar  ::Float64               = 0.234,
             pupdp   ::NTuple{5,Float64}     = (1e-3, 1e-3, 1e-4, 0.1, 0.2),
             ntry    ::Int64                 = 2,
             nlim    ::Int64                 = 500,
             δt      ::Float64               = 1e-3,
             prints  ::Int64                 = 5,
             survival::Bool                  = true,
             mxthf   ::Float64               = Inf,
             tρ      ::Dict{String, Float64} = Dict(&quot;&quot; =&gt; 1.0))</code></pre><p>Run insane for GBM birth-death.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/mcmc_gbmct.jl#L15-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.insane_gbmbd" href="#Tapestree.INSANE.insane_gbmbd"><code>Tapestree.INSANE.insane_gbmbd</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insane_gbmbd(tree    ::sT_label;
             λ0_prior::NTuple{2,Float64}     = (0.05, 148.41),
             μ0_prior::NTuple{2,Float64}     = (0.05, 148.41),
             α_prior ::NTuple{2,Float64}     = (0.0, 1.0),
             σλ_prior::NTuple{2,Float64}     = (0.05, 0.05),
             σμ_prior::NTuple{2,Float64}     = (3.0, 0.1),
             niter   ::Int64                 = 1_000,
             nthin   ::Int64                 = 10,
             nburn   ::Int64                 = 200,
             nflush  ::Int64                 = nthin,
             ofile   ::String                = string(homedir(), &quot;/ibd&quot;),
             ϵi      ::Float64               = 0.2,
             λi      ::Float64               = NaN,
             μi      ::Float64               = NaN,
             αi      ::Float64               = 0.0,
             σλi     ::Float64               = 0.01,
             σμi     ::Float64               = 0.01,
             pupdp   ::NTuple{5,Float64}     = (1e-3, 1e-3, 1e-4, 0.1, 0.2),
             δt      ::Float64               = 1e-3,
             survival::Bool                  = true,
             mxthf   ::Float64               = 0.1,
             prints  ::Int64                 = 5,
             stnλ    ::Float64               = 0.5,
             stnμ    ::Float64               = 0.5,
             tρ      ::Dict{String, Float64} = Dict(&quot;&quot; =&gt; 1.0))</code></pre><p>Run insane for <code>bdd</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/mcmc_gbmbd.jl#L15-L43">source</a></section><section><div><pre><code class="language-julia hljs">insane_gbmbd(tree    ::sT_label,
             tv      ::Vector{Vector{Float64}},
             ev      ::Vector{Vector{Float64}};
             λ0_prior::NTuple{2,Float64}     = (0.05, 148.41),
             μ0_prior::NTuple{2,Float64}     = (0.05, 148.41),
             α_prior ::NTuple{2,Float64}     = (0.0, 1.0),
             σλ_prior::NTuple{2,Float64}     = (0.05, 0.05),
             σμ_prior::NTuple{2,Float64}     = (3.0, 0.1),
             niter   ::Int64                 = 1_000,
             nthin   ::Int64                 = 10,
             nburn   ::Int64                 = 200,
             nflush  ::Int64                 = nthin,
             ofile   ::String                = string(homedir(), &quot;/ibd_efx&quot;),
             ϵi      ::Float64               = 0.2,
             λi      ::Float64               = NaN,
             αi      ::Float64               = 0.0,
             σλi     ::Float64               = 0.01,
             σμi     ::Float64               = 0.01,
             pupdp   ::NTuple{4,Float64}     = (1e-3, 1e-3, 0.1, 0.2),
             δt      ::Float64               = 1e-3,
             prints  ::Int64                 = 5,
             survival::Bool                  = true,
             mxthf   ::Float64               = 0.1,
             tρ      ::Dict{String, Float64} = Dict(&quot;&quot; =&gt; 1.0))</code></pre><p>Run insane for <code>gbm-bd</code> with fixed extinction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/insane/mcmc_gbmbd_efx.jl#L15-L42">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../cbd/">« Constant birth-death</a><a class="docs-footer-nextpage" href="../cfbd/">Constant fossilized birth-death »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.2 on <span class="colophon-date" title="Thursday 15 May 2025 12:22">Thursday 15 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
