<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Diffused Brownian motion · Tapestree.jl</title><meta name="title" content="Diffused Brownian motion · Tapestree.jl"/><meta property="og:title" content="Diffused Brownian motion · Tapestree.jl"/><meta property="twitter:title" content="Diffused Brownian motion · Tapestree.jl"/><meta name="description" content="Documentation for Tapestree.jl."/><meta property="og:description" content="Documentation for Tapestree.jl."/><meta property="twitter:description" content="Documentation for Tapestree.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.png" alt="Tapestree.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.png" alt="Tapestree.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../installation/">Installation</a></li><li><a class="tocitem" href="../../../quick_start/">Quick start</a></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">INSANE</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../contents/">Contents</a></li><li><a class="tocitem" href="../io/">Input and structures</a></li><li><a class="tocitem" href="../cbd/">Constant birth-death</a></li><li><a class="tocitem" href="../bdd/">Birth-death diffusion</a></li><li><a class="tocitem" href="../cfbd/">Constant fossilized birth-death</a></li><li><a class="tocitem" href="../fbdd/">Fossilized birth-death diffusion</a></li><li class="is-active"><a class="tocitem" href>Diffused Brownian motion</a><ul class="internal"><li><a class="tocitem" href="#Simulations"><span>Simulations</span></a></li><li><a class="tocitem" href="#Inference"><span>Inference</span></a></li></ul></li><li><a class="tocitem" href="../processing/">Processing</a></li><li><a class="tocitem" href="../iplots/">Plotting</a></li></ul></li><li><a class="tocitem" href="../../tribe/">TRIBE</a></li><li><a class="tocitem" href="../../esse/">ESSE</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li><a class="is-disabled">INSANE</a></li><li class="is-active"><a href>Diffused Brownian motion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Diffused Brownian motion</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl/blob/master/docs/src/man/insane/dbm.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Diffused-Brownian-motion-process-(DBM)"><a class="docs-heading-anchor" href="#Diffused-Brownian-motion-process-(DBM)">Diffused Brownian motion process (DBM)</a><a id="Diffused-Brownian-motion-process-(DBM)-1"></a><a class="docs-heading-anchor-permalink" href="#Diffused-Brownian-motion-process-(DBM)" title="Permalink"></a></h1><p>This is a model of trait evolution where an univariate trait <span>$x(t)$</span> evolves under a diffused Brownian motion with an underlying evolutionary rate <span>$\sigma^2(t)$</span> that is also itself evolving separately according to Geometric Brownian motion:</p><p class="math-container">\[dx(t) = \alpha_x dt + \sigma(t) d W(t) \\
d(\text{ln}(\sigma^2(t)) = \alpha_{\sigma} dt + \gamma d W(t)\]</p><p>where <span>$\alpha_x$</span> is the trait drift (general trait tendency to increase or decrease), <span>$\alpha_{\sigma}$</span> is the drift in evolutionary rates, and <span>$\gamma$</span> represents the heterogeneity in evolutionary rates.</p><h2 id="Simulations"><a class="docs-heading-anchor" href="#Simulations">Simulations</a><a id="Simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Simulations" title="Permalink"></a></h2><p>In the DBM, we are not modeling the realization of the tree, but rather a process that evolved along the tree. Thus, to simulate, we need a tree to be used as template so that we can simulate on top. So if we have a <code>tree</code> object of type <code>sT_label</code> or <code>sTf_label</code>, we can simulate a trait with a starting trait value of <code>x0</code> (<span>$x(t = 0)$</span>), with drift <code>αx</code> (<span>$\alpha_x$</span>), undergoing a starting rate of <code>σ20</code> (<span>$\sigma^2(t = 0)$</span>) with drift <code>ασ</code> (<span>$\alpha_{\sigma}$</span>), with a maximal discretization time step of <code>δt</code>:</p><pre><code class="language-julia hljs">sim_dbm(tree, x0 = 0.0, αx = 0.0, σ20 = 0.1, ασ = 0.0, γ = 0.1, δt = 1e-3)</code></pre><p>which returns a tree of type <code>sTxs</code>, holding the simulation.</p><p>It might also be useful to return a <code>Dictionary</code> with the final trait values at each sampled species. For this, use the same function, in the same argument order but not using named (keyword) arguments. For instance, the same simulation above, but returning both a <code>sTxs</code> tree named <code>tr</code> and a dictionary of species values named <code>xd</code>:</p><pre><code class="language-julia hljs">tr, xd = sim_dbm(tree, 0.0, 0.0, 0.1, 0.0, 0.1, 1e-3)</code></pre><p>We can plot the resulting tree using Tapestree&#39;s plot recipes (<a href="../iplots/#Insane-plots">Insane plots</a>). For example to plot the trait evolution colored by the logarithmic rates:</p><pre><code class="language-julia hljs">plot(xv, tr, zf = lσ2)</code></pre><h2 id="Inference"><a class="docs-heading-anchor" href="#Inference">Inference</a><a id="Inference-1"></a><a class="docs-heading-anchor-permalink" href="#Inference" title="Permalink"></a></h2><p>For a given <code>sT_label</code> or <code>sTf_label</code> type <code>tree</code> object and a Dictionary <code>xavg</code> with a <code>String</code> key pointing to a <code>Float64</code> number (<em>i.e.</em>, <code>Dict{String, Float64}</code>), where matching tip labels point to the trait value. If species labels are not included in the dictionary, the trait value is assumed missing. </p><pre><code class="language-julia hljs">r, td = insane_dbm(tree, 
                   xavg,
                   γ_prior  = (0.05, 0.05),
                   αx_prior = (0.0, 10.0),
                   ασ_prior = (0.0, 10.0),
                   nburn    = 10_000,
                   niter    = 100_000,
                   nthin    = 1_000,
                   nflush   = 1_000,
                   ofile    = &quot;&lt;...directory...&gt;&quot;,
                   δt       = 1e-3)</code></pre><p>Finally, error or uncertainty around trait values can be included (assuming Normal variance) by setting another Dictionary, called say <code>xsv</code>, (also <code>Dict{String, Float64}</code>), where tip values point to the variance around trait values. Again, if tip labels are not included in this dictionary, it is assumed that there is no error around tip values. Then you specify this dictionary on the argument <code>xs</code>:</p><pre><code class="language-julia hljs">r, td = insane_dbm(tree, 
                   xavg, 
                   xs       = xsv,
                   γ_prior  = (0.05, 0.05),
                   αx_prior = (0.0, 10.0),
                   ασ_prior = (0.0, 10.0),
                   nburn    = 10_000,
                   niter    = 100_000,
                   nthin    = 1_000,
                   nflush   = 1_000,
                   ofile    = &quot;&lt;...directory...&gt;&quot;,
                   δt       = 1e-3)</code></pre><p>Full documentation</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.sim_dbm" href="#Tapestree.INSANE.sim_dbm"><code>Tapestree.INSANE.sim_dbm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sim_dbm(tree::iTree; 
        x0  ::Float64 = 0.0,
        αx  ::Float64 = 0.0,
        σ20 ::Float64 = 0.1,
        ασ  ::Float64 = 0.0,
        γ   ::Float64 = 0.1,
        δt  ::Float64 = 1e-3)</code></pre><p>Simulate a diffused Brownian motion given starting values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/21a6f705e4b4bf0789124aa93b404415183c2ed0/src/insane/sim_dbm.jl#L15-L25">source</a></section><section><div><pre><code class="language-julia hljs">sim_dbm(tree::Tlabel, 
        x0  ::Float64,
        αx  ::Float64,
        σ20 ::Float64,
        ασ  ::Float64,
        γ   ::Float64,
        δt  ::Float64)</code></pre><p>Simulate a diffused Brownian motion given starting values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/21a6f705e4b4bf0789124aa93b404415183c2ed0/src/insane/sim_dbm.jl#L99-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.insane_dbm" href="#Tapestree.INSANE.insane_dbm"><code>Tapestree.INSANE.insane_dbm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insane_dbm(tree     ::Tlabel,
           xa       ::Dict{String, Float64};
           xs       ::Dict{String, Float64} = Dict{String,Float64}(),
           αx_prior ::NTuple{2,Float64} = (0.0, 10.0),
           ασ_prior ::NTuple{2,Float64} = (0.0, 10.0),
           γ_prior  ::NTuple{2,Float64} = (0.05, 0.05),
           niter    ::Int64             = 1_000,
           nthin    ::Int64             = 10,
           nburn    ::Int64             = 200,
           nflush   ::Int64             = nthin,
           ofile    ::String            = string(homedir(), &quot;/dbm&quot;),
           αi       ::Float64           = 0.0,
           γi       ::Float64           = 1e-3,
           pupdp    ::NTuple{4,Float64} = (0.1, 0.1, 0.05, 0.9),
           δt       ::Float64           = 1e-3,
           stn      ::Float64           = 0.1,
           mxthf    ::Float64           = Inf,
           prints   ::Int64             = 5)</code></pre><p>Run diffused Brownian motion trait evolution model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/21a6f705e4b4bf0789124aa93b404415183c2ed0/src/insane/mcmc_dbm.jl#L15-L36">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../fbdd/">« Fossilized birth-death diffusion</a><a class="docs-footer-nextpage" href="../processing/">Processing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Wednesday 14 May 2025 13:49">Wednesday 14 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
