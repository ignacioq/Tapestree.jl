<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Processing · Tapestree.jl</title><meta name="title" content="Processing · Tapestree.jl"/><meta property="og:title" content="Processing · Tapestree.jl"/><meta property="twitter:title" content="Processing · Tapestree.jl"/><meta name="description" content="Documentation for Tapestree.jl."/><meta property="og:description" content="Documentation for Tapestree.jl."/><meta property="twitter:description" content="Documentation for Tapestree.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.png" alt="Tapestree.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.png" alt="Tapestree.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../installation/">Installation</a></li><li><a class="tocitem" href="../../../quick_start/">Quick start</a></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">INSANE</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../contents/">Contents</a></li><li><a class="tocitem" href="../io/">Input and structures</a></li><li><a class="tocitem" href="../cbd/">Constant birth-death</a></li><li><a class="tocitem" href="../bdd/">Birth-death diffusion</a></li><li><a class="tocitem" href="../cfbd/">Constant fossilized birth-death</a></li><li><a class="tocitem" href="../fbdd/">Fossilized birth-death diffusion</a></li><li><a class="tocitem" href="../obd/">Occurrence birth-death</a></li><li><a class="tocitem" href="../dbm/">Diffused Brownian motion</a></li><li class="is-active"><a class="tocitem" href>Processing</a><ul class="internal"><li><a class="tocitem" href="#Basic-tree-information"><span>Basic tree information</span></a></li><li><a class="tocitem" href="#Tree-vector-statistics"><span>Tree vector statistics</span></a></li><li><a class="tocitem" href="#Tree-labels-and-obtaining-subtrees"><span>Tree labels and obtaining subtrees</span></a></li><li><a class="tocitem" href="#Lineage-and-Diversity-through-time-(LTT-and-DTT)"><span>Lineage and Diversity through time (LTT &amp; DTT)</span></a></li><li><a class="tocitem" href="#Trees-with-diffusion-information-(*e.g.*,-BDD,-FBDD,-DBM)"><span>Trees with diffusion information (<em>e.g.</em>, BDD, FBDD, DBM)</span></a></li><li><a class="tocitem" href="#Insane-tree-manipulation-functions"><span>Insane tree manipulation functions</span></a></li></ul></li><li><a class="tocitem" href="../iplots/">Plotting</a></li></ul></li><li><a class="tocitem" href="../../tribe/">TRIBE</a></li><li><a class="tocitem" href="../../esse/">ESSE</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li><a class="is-disabled">INSANE</a></li><li class="is-active"><a href>Processing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Processing</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl/blob/master/docs/src/man/insane/processing.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Insane-tree-data-access-and-processing-functions"><a class="docs-heading-anchor" href="#Insane-tree-data-access-and-processing-functions">Insane tree data access and processing functions</a><a id="Insane-tree-data-access-and-processing-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-tree-data-access-and-processing-functions" title="Permalink"></a></h1><h2 id="Basic-tree-information"><a class="docs-heading-anchor" href="#Basic-tree-information">Basic tree information</a><a id="Basic-tree-information-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-tree-information" title="Permalink"></a></h2><p>Basic information about the tree, such as the number tips, the number of extinct tips, the number of fossils, the tree height (duration of the tree) and the tree length (sum of all branch lengths) can be performed using, respectively:</p><pre><code class="language-julia hljs">ntips(tree)
ntipsextinct(tree)
nfossils(tree)
treeheight(tree)
treelength(tree)</code></pre><h2 id="Tree-vector-statistics"><a class="docs-heading-anchor" href="#Tree-vector-statistics">Tree vector statistics</a><a id="Tree-vector-statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Tree-vector-statistics" title="Permalink"></a></h2><p>Julia makes it simple to look at statistics across a vector of trees. For example, using the package <code>Statistics</code>, we can estimate the average number of extinct species on tree vector <code>tv</code> by simply:</p><pre><code class="language-julia hljs">using Statistics 

mean(ntipsextinct, tv)</code></pre><p>See the documentation of <code>mean</code> for more details, but basically, <code>mean</code>, and many other functions in Julia allow to perform a undefined function on each element before calculating the mean. In this case, we are estimating the number of extinct tips in each tree in <code>tv</code>, and then averaging over them.</p><h2 id="Tree-labels-and-obtaining-subtrees"><a class="docs-heading-anchor" href="#Tree-labels-and-obtaining-subtrees">Tree labels and obtaining subtrees</a><a id="Tree-labels-and-obtaining-subtrees-1"></a><a class="docs-heading-anchor-permalink" href="#Tree-labels-and-obtaining-subtrees" title="Permalink"></a></h2><p>For labelled trees, one can extract the tip labels using <code>tiplabels</code>. Moreover we can create subclades based on a vector of tips, where the subclade will be the minimum tree that has all the tips. For example, for a vector <code>tip_vector</code> holding Strings that correspond to the tip labels in the tree of type sT_label, we can use</p><pre><code class="language-julia hljs">subclade(tree, tip_vector)</code></pre><p>However, most time we want to extract subclades of other types of trees. Since these do not hold label information but should be ordered in the same order as the <code>sT_label</code> tree, one has to use both. </p><div class="admonition is-warning" id="Warning-1124ed62d384e10"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-1124ed62d384e10" title="Permalink"></a></header><div class="admonition-body"><p>if you change the order of either the <code>sT_label</code> tree or the single of vector of trees of other types, this will not work. </p></div></div><p>Thus, if we want a the subclades that have the tips in <code>tip_vector</code>, we can use</p><pre><code class="language-julia hljs">subclade(tv, tree, tip_vector, true)</code></pre><p>where the last argument states if returning the stem or crown tree.</p><h2 id="Lineage-and-Diversity-through-time-(LTT-and-DTT)"><a class="docs-heading-anchor" href="#Lineage-and-Diversity-through-time-(LTT-and-DTT)">Lineage and Diversity through time (LTT &amp; DTT)</a><a id="Lineage-and-Diversity-through-time-(LTT-and-DTT)-1"></a><a class="docs-heading-anchor-permalink" href="#Lineage-and-Diversity-through-time-(LTT-and-DTT)" title="Permalink"></a></h2><p>One can also estimate the Lineage Through Time (LTT), or, for a data augmented tree (or a vector of trees), the Diversity Through Time (DTT) using </p><pre><code class="language-julia hljs">ltt(tree)</code></pre><p>To be clear, the LTT is usually used to describe the accumulation of reconstructed lineages (those that have been sampled) while DTT is used to describe estimated diversity (sampled <strong>and unsampled</strong> lineages). Thus, the result is either LTT or DTT simply depending on the tree you use as input.</p><p>We can also estimate the ltt for a tree vector <code>tv</code> using</p><pre><code class="language-julia hljs">ltt(tv)</code></pre><h2 id="Trees-with-diffusion-information-(*e.g.*,-BDD,-FBDD,-DBM)"><a class="docs-heading-anchor" href="#Trees-with-diffusion-information-(*e.g.*,-BDD,-FBDD,-DBM)">Trees with diffusion information (<em>e.g.</em>, BDD, FBDD, DBM)</a><a id="Trees-with-diffusion-information-(*e.g.*,-BDD,-FBDD,-DBM)-1"></a><a class="docs-heading-anchor-permalink" href="#Trees-with-diffusion-information-(*e.g.*,-BDD,-FBDD,-DBM)" title="Permalink"></a></h2><h3 id="Estimating-posterior-average-rates-along-the-tree"><a class="docs-heading-anchor" href="#Estimating-posterior-average-rates-along-the-tree">Estimating posterior average rates along the tree</a><a id="Estimating-posterior-average-rates-along-the-tree-1"></a><a class="docs-heading-anchor-permalink" href="#Estimating-posterior-average-rates-along-the-tree" title="Permalink"></a></h3><p>Of particular interest is the estimation of posterior average rates along the reconstructed tree. Since the data augmented (unsampled) lineages change between different iterations of the algorithm, we obtain lineage-specific instantaneous rate distributions only for the reconstructed (observed) part of the trees (the tree we used as input). Consequently, we first need to remove the data augmented lineages from all the trees in the posterior tree vector:</p><pre><code class="language-julia hljs">tv0 = remove_unsampled(tv)</code></pre><p>We can then estimate the average tree using</p><pre><code class="language-julia hljs">tm = imean(tv0)</code></pre><p>We can also estimate any quantile tree, for instance, for the <span>$0.25$</span> quantile tree:</p><pre><code class="language-julia hljs">t025 = iquantile(tv0, 0.25)</code></pre><p>Clearly, these resulting trees can then be further scrutinized as with any other tree in INSANE.</p><h3 id="Other-data-access-and-averaging-functions"><a class="docs-heading-anchor" href="#Other-data-access-and-averaging-functions">Other data access and averaging functions</a><a id="Other-data-access-and-averaging-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Other-data-access-and-averaging-functions" title="Permalink"></a></h3><p>If one wants to obtain the range (<em>i.e.</em>, extrema) of the output of function <code>f</code> on <code>tree</code>, for example, the maximum and minimum speciation rates:</p><pre><code class="language-julia hljs">irange(tree, b)</code></pre><p>If one wants to sample, recursively, some function at regular intervals along a tree, one can use <code>sample</code>. For example if we want to sample speciation rates every <span>$0.1$</span> time units, we can use</p><pre><code class="language-julia hljs">sample(tv, b, 0.1)</code></pre><div class="admonition is-info" id="Note-20c398b7ba928e75"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-20c398b7ba928e75" title="Permalink"></a></header><div class="admonition-body"><p>Here we are sampling along each branch of the tree in recursive order, not sampling across lineages through time. </p></div></div><p>If we would like to extract an array across lineages in a given tree of the output of function <code>f</code>, we would use <code>time_rate</code>. For example, if we want the cross-lineage extinction rates of a tree of type <code>iTbd</code> sampled every <span>$0.5$</span> time units, we would use</p><pre><code class="language-julia hljs">time_rate(tv, d, 0.5)</code></pre><p>which returns a vector of vectors, where each element is a time holding the rates (in this case extinction rates) of all contemporary lineages at that time.</p><p>Finally, a convenience wrapper to extract information recursively from a tree is <code>trextract</code>. For example, if we want all branch lengths for a tree, we can use</p><pre><code class="language-julia hljs">trextract(tree, e)</code></pre><p>Below are some functions to obtain data from trees.</p><p>Full documentation</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.tiplabels" href="#Tapestree.INSANE.tiplabels"><code>Tapestree.INSANE.tiplabels</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tiplabels(tree::T) where {T &lt;: Tlabel}</code></pre><p>Returns tip labels for <code>sT_label</code> and <code>sTf_label</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L252-L256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.ntips" href="#Tapestree.INSANE.ntips"><code>Tapestree.INSANE.ntips</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ntips(tree::T) where {T &lt;: iTree}</code></pre><p>Return the number of tip nodes for <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L1305-L1309">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.ntipsalive" href="#Tapestree.INSANE.ntipsalive"><code>Tapestree.INSANE.ntipsalive</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ntipsalive(tree::T) where {T &lt;: iTree}</code></pre><p>Return the number of alive nodes for <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L1357-L1361">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.ntipsextinct" href="#Tapestree.INSANE.ntipsextinct"><code>Tapestree.INSANE.ntipsextinct</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ntipsextinct(tree::T) where {T &lt;: iTree}</code></pre><p>Return the number of extinct nodes for <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L1439-L1443">source</a></section><section><div><pre><code class="language-julia hljs">ntipsextinct(Ξ::Vector{T}) where {T &lt;: iTree}</code></pre><p>Return the number of extinct nodes in <code>Ξ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/decoupled_trees.jl#L1133-L1137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.treeheight" href="#Tapestree.INSANE.treeheight"><code>Tapestree.INSANE.treeheight</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">treeheight(tree::T) where {T &lt;: iTree}</code></pre><p>Return the tree height of <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L1031-L1035">source</a></section><section><div><pre><code class="language-julia hljs">treeheight(tree::T) where {T &lt;: Union{iTf, iTpbd}}</code></pre><p>Return the tree height of <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L1048-L1052">source</a></section><section><div><pre><code class="language-julia hljs">treeheight(tree::T, nd::Int64) where {T &lt;: iTree}</code></pre><p>Return the tree height of <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L1070-L1074">source</a></section><section><div><pre><code class="language-julia hljs">treeheight(tree::T, nd::Int64) where {T &lt;: Union{iTf, iTpbd}}</code></pre><p>Return the tree height of <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L1087-L1091">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.treelength" href="#Tapestree.INSANE.treelength"><code>Tapestree.INSANE.treelength</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">treelength(tree::T) where {T &lt;: iTree}</code></pre><p>Return the branch length sum of <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L871-L875">source</a></section><section><div><pre><code class="language-julia hljs">treelength(tree::T, ets::Vector{Float64})  where {T &lt;: Union{iTf, iTpbd}}</code></pre><p>Return the branch length sum of <code>tree</code> at different epochs, initialized at <code>l</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L919-L923">source</a></section><section><div><pre><code class="language-julia hljs">treelength(Ξ::Vector{T}) where {T &lt;: iTree}</code></pre><p>Return the branch length sum of <code>Ξ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/decoupled_trees.jl#L1038-L1042">source</a></section><section><div><pre><code class="language-julia hljs">treelength(Ξ  ::Vector{T},
           ets::Vector{Float64},
           bst::Vector{Float64},
           eix::Vector{Int64})  where {T &lt;: iTf}</code></pre><p>Return the branch length sum of <code>tree</code> at different epochs, initialized at <code>l</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/decoupled_trees.jl#L1054-L1061">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.ltt" href="#Tapestree.INSANE.ltt"><code>Tapestree.INSANE.ltt</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ltt(tree::T) where {T &lt;: iTree}</code></pre><p>Returns number of species through time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L2187-L2191">source</a></section><section><div><pre><code class="language-julia hljs">ltt(tree::Vector{T}) where {T &lt;: iTree}</code></pre><p>Returns number of species through time for a tree vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L2294-L2298">source</a></section><section><div><pre><code class="language-julia hljs">ltt(tree::T, tor::Float64) where {T &lt;: iTree}</code></pre><p>Returns number of species through time for a tree vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L2310-L2314">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.iscrowntree" href="#Tapestree.INSANE.iscrowntree"><code>Tapestree.INSANE.iscrowntree</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iscrowntree(tree::T) where {T &lt;: iTree}</code></pre><p>Return if the tree is a crown tree.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L55-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.irange" href="#Tapestree.INSANE.irange"><code>Tapestree.INSANE.irange</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">irange(tree::T, f::Function) where {T &lt;: iTree}</code></pre><p>Return the extrema of the output of function <code>f</code> on <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L981-L985">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.time_rate" href="#Tapestree.INSANE.time_rate"><code>Tapestree.INSANE.time_rate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">time_rate(tree::T, f::Function, δt::Float64) where {T &lt;: iT}</code></pre><p>Extract values from <code>f</code> function at times sampled every <code>δt</code> across the tree.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_summary.jl#L49-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.trextract" href="#Tapestree.INSANE.trextract"><code>Tapestree.INSANE.trextract</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trextract(tree::iTree, f::Function)</code></pre><p>Perform function <code>f</code> in each recursive tree in <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L2681-L2685">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.subclade" href="#Tapestree.INSANE.subclade"><code>Tapestree.INSANE.subclade</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subclade(tree::iTree, ix::Int64)</code></pre><p>Return the minimum stem subclade according to recursive position <code>ix</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L380-L384">source</a></section><section><div><pre><code class="language-julia hljs">subclade(trees::Vector{T}, 
              ltree::sT_label, 
              tips ::Vector{String},
              stem ::Bool) where {T &lt;: iTree}</code></pre><p>Return the minimum subclade that includes tip labels in <code>tips</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L454-L461">source</a></section><section><div><pre><code class="language-julia hljs">subclade(tree::sT_label, tips::Vector{String})</code></pre><p>Return the minimum subclade that includes tip labels in <code>tips</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L478-L482">source</a></section><section><div><pre><code class="language-julia hljs">subclade(tree::iTree, 
         ltree::sT_label, 
         tips ::Vector{String}, 
         stem ::Bool)</code></pre><p>Return the minimum subclade that includes tip labels in <code>tips</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L496-L503">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.lλ" href="#Tapestree.INSANE.lλ"><code>Tapestree.INSANE.lλ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lλ(tree::T) where {T &lt;: iT}</code></pre><p>Return the speciation rate (speciation completion in a protracted model).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L1735-L1739">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.lμ" href="#Tapestree.INSANE.lμ"><code>Tapestree.INSANE.lμ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lμ(tree::iTbdU)</code></pre><p>Return the extinction rate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L1745-L1749">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.e" href="#Tapestree.INSANE.e"><code>Tapestree.INSANE.e</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">e(id::iB)</code></pre><p>Return initial absolute time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iB.jl#L859-L863">source</a></section><section><div><pre><code class="language-julia hljs">e(tree::T) where {T &lt;: iTree}</code></pre><p>Return edge length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_data.jl#L228-L232">source</a></section></article><h2 id="Insane-tree-manipulation-functions"><a class="docs-heading-anchor" href="#Insane-tree-manipulation-functions">Insane tree manipulation functions</a><a id="Insane-tree-manipulation-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-tree-manipulation-functions" title="Permalink"></a></h2><p>Two important manipulation functions are, first to be able to remove extinct lineages, which can be performed on a tree or a tree vector using</p><pre><code class="language-julia hljs">remove_extinct(tree)</code></pre><p>Similarly, as shown above, one can remove the unsampled lineages (all the data augmented lineages) on a single or vector of trees using</p><pre><code class="language-julia hljs">remove_unsampled(tree)</code></pre><div class="admonition is-info" id="Note-343a573a378e5f33"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-343a573a378e5f33" title="Permalink"></a></header><div class="admonition-body"><p><code>remove_extinct</code> and <code>remove_unsampled</code> are different. First, when performing simulations, the tree is not <code>fixed</code>, which means that if you run <code>remove_unsampled</code>, you will remove the tree. You would have to fix the tree before, which can be done using <code>fixtree!(tree)</code>. Also, if sampling fraction is not <span>$1$</span>, <code>remove_unsampled</code> will also remove lineages alive that were not sampled, while <code>remove_extinct</code> will only remove those lineages extinct.</p></div></div><p>For fossil trees, one can remove all fossils using</p><pre><code class="language-julia hljs">remove_fossils(tree)</code></pre><p>or make a given tree a fossil by using</p><pre><code class="language-julia hljs">fossilize!(tree)</code></pre><p>which will only make fossil that specific tree (not the recursive daughters).</p><p>Full documentation</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.reorder!" href="#Tapestree.INSANE.reorder!"><code>Tapestree.INSANE.reorder!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reorder(tree::T) where {T &lt;: iTree}</code></pre><p>Reorder order of daughter branches according to number of tips, with daughter 1 always having more than daughter 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_manipulation.jl#L40-L45">source</a></section><section><div><pre><code class="language-julia hljs">reorder!(tree::T, treeda::D) where {T &lt;: iTree, D &lt;: iTree}</code></pre><p>Reorder order of daughter branches for both trees, following tree first, according to number of tips, with daughter1 always having more than daughter 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_manipulation.jl#L84-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.rm_stem!" href="#Tapestree.INSANE.rm_stem!"><code>Tapestree.INSANE.rm_stem!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rm_stem(tree::T) where {T &lt;: iTree}</code></pre><p>Removes stem branch.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_manipulation.jl#L164-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.fixtree!" href="#Tapestree.INSANE.fixtree!"><code>Tapestree.INSANE.fixtree!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fixtree!(tree::T) where {T &lt;: iTree}</code></pre><p>Fix all <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_manipulation.jl#L3075-L3079">source</a></section><section><div><pre><code class="language-julia hljs">fixtree!(tree::T) where {T &lt;: iTf}</code></pre><p>Fix all <code>tree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_manipulation.jl#L3091-L3095">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.remove_extinct" href="#Tapestree.INSANE.remove_extinct"><code>Tapestree.INSANE.remove_extinct</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">remove_extinct(tree::T) where {T &lt;: iTree}</code></pre><p>Remove extinct tips from <code>iTce</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_manipulation.jl#L2112-L2116">source</a></section><section><div><pre><code class="language-julia hljs">remove_extinct(treev::Vector{T}) where {T &lt;: iTree}</code></pre><p>Remove extinct taxa for a vector of trees.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_manipulation.jl#L2124-L2128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.INSANE.remove_unsampled" href="#Tapestree.INSANE.remove_unsampled"><code>Tapestree.INSANE.remove_unsampled</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">remove_unsampled(tree::T) where {T &lt;: iTree}</code></pre><p>Remove unsampled tips from <code>iTree</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_manipulation.jl#L1612-L1616">source</a></section><section><div><pre><code class="language-julia hljs">remove_unsampled(treev::Vector{T}) where {T &lt;: iTree}</code></pre><p>Remove unsampled taxa for a vector of trees.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/68dccbb2f8ad609a9340b2a3ff88fd0be266960f/src/insane/iTree_manipulation.jl#L1624-L1628">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dbm/">« Diffused Brownian motion</a><a class="docs-footer-nextpage" href="../iplots/">Plotting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 4 September 2025 13:04">Thursday 4 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
