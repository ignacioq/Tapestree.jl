<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Input and structures · Tapestree.jl</title><meta name="title" content="Input and structures · Tapestree.jl"/><meta property="og:title" content="Input and structures · Tapestree.jl"/><meta property="twitter:title" content="Input and structures · Tapestree.jl"/><meta name="description" content="Documentation for Tapestree.jl."/><meta property="og:description" content="Documentation for Tapestree.jl."/><meta property="twitter:description" content="Documentation for Tapestree.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.png" alt="Tapestree.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.png" alt="Tapestree.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../installation/">Installation</a></li><li><a class="tocitem" href="../../../quick_start/">Quick start</a></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">INSANE</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../contents/">Contents</a></li><li class="is-active"><a class="tocitem" href>Input and structures</a><ul class="internal"><li><a class="tocitem" href="#Insane-tree-and-model-input/output"><span>Insane tree and model input/output</span></a></li></ul></li><li><a class="tocitem" href="../cbd/">Constant birth-death</a></li><li><a class="tocitem" href="../bdd/">Birth-death diffusion</a></li><li><a class="tocitem" href="../cfbd/">Constant fossilized birth-death</a></li><li><a class="tocitem" href="../fbdd/">Fossilized birth-death diffusion</a></li><li><a class="tocitem" href="../dbm/">Diffused Brownian motion</a></li><li><a class="tocitem" href="../processing/">Processing</a></li><li><a class="tocitem" href="../iplots/">Plotting</a></li></ul></li><li><a class="tocitem" href="../../tribe/">TRIBE</a></li><li><a class="tocitem" href="../../esse/">ESSE</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li><a class="is-disabled">INSANE</a></li><li class="is-active"><a href>Input and structures</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Input and structures</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl/blob/master/docs/src/man/insane/io.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Insane-input-and-structures"><a class="docs-heading-anchor" href="#Insane-input-and-structures">Insane input &amp; structures</a><a id="Insane-input-and-structures-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-input-and-structures" title="Permalink"></a></h1><h2 id="Insane-tree-and-model-input/output"><a class="docs-heading-anchor" href="#Insane-tree-and-model-input/output">Insane tree and model input/output</a><a id="Insane-tree-and-model-input/output-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-tree-and-model-input/output" title="Permalink"></a></h2><h3 id="Insane-trees"><a class="docs-heading-anchor" href="#Insane-trees">Insane trees</a><a id="Insane-trees-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-trees" title="Permalink"></a></h3><p>INSANE uses different types of trees, but all are recursive structures. All trees have at least three fields: </p><ul><li><code>d1</code> which corresponds to the left daughter (either another tree structure or <code>nothing</code> if it is a tip).</li><li><code>d2</code> which corresponds to the right daughter (also either another tree structure or <code>nothing</code> if it is not a bifurcation).</li><li><code>e</code> a decimal number specifying the edge length of the tree.</li></ul><p>For all tree output from simulations and inference (all expect labelled trees):</p><ul><li><code>fx</code> a Boolean stating if tree is fixed or not. That is, if it corresponds to a sampled (<code>fx = true</code>) or unsampled (<code>fx = false</code>) lineage.</li></ul><p>For all trees that allow for extinction:</p><ul><li><code>iμ</code> a Boolean stating if tree is extinct (<code>iμ = true</code>) or not (<code>iμ = false</code>).</li></ul><p>For fossil trees:</p><ul><li><code>iψ</code> a Boolean stating if tree is fossil (<code>iψ = true</code>) or not (<code>iψ = false</code>).</li></ul><h3 id="Insane-simple-trees-(sT-and-sTf)"><a class="docs-heading-anchor" href="#Insane-simple-trees-(sT-and-sTf)">Insane simple trees (<code>sT</code> &amp; <code>sTf</code>)</a><a id="Insane-simple-trees-(sT-and-sTf)-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-simple-trees-(sT-and-sTf)" title="Permalink"></a></h3><ol><li><code>sT_label</code>: is a simple labelled tree, and is the one required as input to perform inference. </li><li><code>sTf_label</code>: is a simple fossil labelled tree, and is the one required as input to perform inference for fossilized birth-death models. </li></ol><ul><li>They have the additional field <code>l</code> for label.</li></ul><div class="admonition is-info" id="Note-316510cbb0cebd77"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-316510cbb0cebd77" title="Permalink"></a></header><div class="admonition-body"><p>All other model specific tree types can be converted to <code>sT_label</code> by using the latter as a function: <code>tree = sT_label(tree_of_other_type)</code>. For fossil trees as well by using <code>tree = sTf_label(fossil_tree_of_other_type)</code>.</p></div></div><ol><li><code>sTpb</code>: is a simple pure-birth tree for the constant pure-birth (Yule) model.</li><li><code>sTbd</code>: is a simple birth-death tree for the constant birth-death model.</li><li><code>sTfbd</code>: is a simple fossil birth-death tree for the constant and episodic fossilized birth-death models.</li></ol><h3 id="Insane-BDD-and-FBDD-trees-(iT)"><a class="docs-heading-anchor" href="#Insane-BDD-and-FBDD-trees-(iT)">Insane BDD &amp; FBDD trees (<code>iT</code>)</a><a id="Insane-BDD-and-FBDD-trees-(iT)-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-BDD-and-FBDD-trees-(iT)" title="Permalink"></a></h3><p>All <code>iT</code> trees specify to birth-death diffusion trees with different extinction assumptions and all hold the following extra fields:</p><ul><li><code>dt</code> a decimal specifying the time step of the GBM discretization.</li><li><code>fdt</code> a decimal specifying the final time step of the GBM discretization.</li><li><code>lλ</code> an array specifying the Brownian motion evolution of log-speciation rates.</li></ul><p>And have the following concrete types:</p><ol><li><code>iTpb</code>, <code>iTce</code> and <code>iTct</code>: are BDD trees with no-extinction (pure-birth), constant extinction and constant turnover, respectively.</li><li><code>iTbd</code>: the full BDD tree.</li><li><code>iTfbd</code>: for the fossil BDD tree.</li></ol><ul><li>These last two have the additional field <code>lμ</code>:  an array specifying the Brownian motion evolution of log-extinction rates.</li></ul><h3 id="Insane-DBM-trees-(sTxs)"><a class="docs-heading-anchor" href="#Insane-DBM-trees-(sTxs)">Insane DBM trees (<code>sTxs</code>)</a><a id="Insane-DBM-trees-(sTxs)-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-DBM-trees-(sTxs)" title="Permalink"></a></h3><ul><li><code>dt</code> a decimal specifying the time step of the GBM discretization.</li><li><code>fdt</code> a decimal specifying the final time step of the GBM discretization.</li><li><code>xv</code> an array specifying the Brownian motion evolution of traits.</li><li><code>lσ2</code> an array specifying the Geometric Brownian motion evolution of rates.</li></ul><h3 id="Reading-and-saving-newick-trees"><a class="docs-heading-anchor" href="#Reading-and-saving-newick-trees">Reading and saving newick trees</a><a id="Reading-and-saving-newick-trees-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-and-saving-newick-trees" title="Permalink"></a></h3><h4 id="Extant-only-trees"><a class="docs-heading-anchor" href="#Extant-only-trees">Extant only trees</a><a id="Extant-only-trees-1"></a><a class="docs-heading-anchor-permalink" href="#Extant-only-trees" title="Permalink"></a></h4><p>Tapestree can read files in the simple newick format using the <code>read_newick</code> function:</p><pre><code class="language-julia hljs">tree = read_newick(joinpath(dirname(pathof(Tapestree)), &quot;..&quot;, &quot;data&quot;, &quot;tree_5.tre&quot;))</code></pre><div class="admonition is-info" id="Note-d580e91f1d7518fc"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-d580e91f1d7518fc" title="Permalink"></a></header><div class="admonition-body"></div></div><p>This tree has type <code>sT_label</code>, which stands for simple labelled tree. You can check this using</p><pre><code class="language-julia hljs">    typeof(tree)
    ```

#### Trees with fossils

Tapestree reads fossilized birth-death trees in newick format using the `read_newick` function, as above, but specifying as second argument `true`:</code></pre><p>julia tree = read<em>newick(joinpath(dirname(pathof(Tapestree)), &quot;..&quot;, &quot;data&quot;, &quot;tree</em>6.tre&quot;), true)</p><pre><code class="nohighlight hljs">
In addition, because of rounding errors, a very recent fossil tip might actually be labelled as an extant tip or vice-versa. To control for the time from which extant species are differentiated from fossil tip ones, the argument `ne` can be used:</code></pre><p>julia tree = read<em>newick(joinpath(dirname(pathof(Tapestree)), &quot;..&quot;, &quot;data&quot;, &quot;tree</em>6.tre&quot;), true, ne = 0.1)</p><pre><code class="nohighlight hljs">
Tapestree can also write trees using `write_newick`</code></pre><p>julia write_newick(tree, &quot;&lt;directory&gt;&quot;)</p><pre><code class="nohighlight hljs">
!!! note
    Only `*_label` trees (_i.e._, `sT_label` &amp; `sTf_label`) have labels. So if you want to save a DA tree with the original tip labels plus new names to the data augmented trees, you first will have to create a labelled tree from the `DA_tree` and the loaded labelled `tree` and then save it:
    ```julia
    write_newick(sT_label(DA_tree, tree), &quot;&lt;directory&gt;&quot;)
    ```

### Reading and saving model output

All models can return and/or save the output by writing directly to a file on the fly and within the Julia session when the model finishes. There are two outputs:

1. The governing parameters trace, which is saved as a `.log` file and returned as the first object once the algorithm finished. These can be conveniently read in the Tracer software [https://github.com/beast-dev/tracer/releases/tag/v1.7.2])https://github.com/beast-dev/tracer/releases/tag/v1.7.2).
2. The DA trees as a tree vector which are saved as a `.txt` file (of the same name as the `.log`) and returned as the second object once the algorithm finished. 

The DA trees written in the insane-specific `.txt` file can be read using the `iread()` function, which only needs the specific file directory as input, but also accepts an optional (keyword) argument `ix` that indicates the specific tree iterations to read, as an `OrdinalRange` object. For instance, to read only the first ``50`` trees, one can use `iread(&quot;&lt;directory to txt&gt;&quot;, ix = 1:50`. To read only the trees every ``10`` iterations from the ``100`` to ``400`` sampled, one can use `ix = 100:10:400`, and so on. This can be helpful to avoid high computation costs of reading very large files.

You can save any individual or vector of insane trees using the `iwrite()` function: `iwrite(trees, &quot;&lt;directory&gt;&quot;)`, which can be read by `Tapestree`. For portability, you can also save the DA trees as nexus files where nodes have been annotated with the vector of rates using `write_nexus(trees, tree, &quot;&lt;directory&gt;&quot;)`, where trees is the tree vector and tree is the original labelled tree (_i.e._, the one you used as input into an insane model).


## Insane models


### Tree input

All inference functions require a phylogenetic tree of type `sT_label` or `sTf_label`, that is, a simple labelled tree. This is the default object type when using the `read_newick` function. However, when using simulations from models or `iread`, the resulting type is specific to the model (for computational efficiency). One can easily create a tree of type `sT_label` or `sTf_label` from any other tree by using `sT_label(tree)` and `sTf_label(tree)`, respectively. The output can then be used to perform inference.


### Common (keyword) arguments across all insane inference models

* `nburn`: specifies the number of iterations to discard as burn-in.
* `niter`: specifies the number of MCMC iterations. 
* `nthin`: specifies the iteration frequency at which to save the parameters **in the julia session** (_i.e._,`nthin = 2` specifies saving every 2 iterations), 
* `nflush`: specifies the frequency at which to save **to file**. 
* `ofile`: specifies the directory where the results will be written. 
* `tρ`: controls the sampling fraction and receives a `Dictionary` as input, with a `String` key pointing to a `Float64` number (_i.e._, `Dict{String, Float64}`). If the dictionary is of length 1 with an empty string, then the insane sets this as a the global sampling fraction. For example, to set a sampling fraction of `0.6`, one show input `tρ = Dict(&quot;&quot; =&gt; 0.6)`. Most times, however, sampling fraction is not uniform across the tree, but rather some part so the tree is more heavily sampled than others, to accommodate these variability, you can input a dictionary of the same length as the number of tips in the tree, where the dictionary key string is the tip label pointing to the specific sampling fraction value. For example, for two tips, named `tip_1` and `tip_2`, one could input `tρ = Dict(&quot;tip_1&quot; =&gt; 0.5, &quot;tip_2&quot; =&gt; 0.3)`. Make sure to specify all tips when assigning different sampling fractions across the tips, even ones with `1.0`. 
* `prints`: specifies the number of seconds to refresh the progress meter.
* `survival`: For those modesl with extinction, `true` or `false` if to condition the likelihood on survival.



Full documentation</code></pre><p>@docs read<em>newick write</em>newick iread iwrite write_nexus ```</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../contents/">« Contents</a><a class="docs-footer-nextpage" href="../cbd/">Constant birth-death »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.2 on <span class="colophon-date" title="Wednesday 14 May 2025 14:26">Wednesday 14 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
