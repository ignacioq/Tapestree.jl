<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ESSE · Tapestree.jl</title><meta name="title" content="ESSE · Tapestree.jl"/><meta property="og:title" content="ESSE · Tapestree.jl"/><meta property="twitter:title" content="ESSE · Tapestree.jl"/><meta name="description" content="Documentation for Tapestree.jl."/><meta property="og:description" content="Documentation for Tapestree.jl."/><meta property="twitter:description" content="Documentation for Tapestree.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="Tapestree.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="Tapestree.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li><li><a class="tocitem" href="../../quick_start/">Quick start</a></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">INSANE</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../insane/contents/">Contents</a></li><li><a class="tocitem" href="../insane/io/">Input and structures</a></li><li><a class="tocitem" href="../insane/cbd/">Constant birth-death</a></li><li><a class="tocitem" href="../insane/bdd/">Birth-death diffusion</a></li><li><a class="tocitem" href="../insane/cfbd/">Constant fossilized birth-death</a></li><li><a class="tocitem" href="../insane/fbdd/">Fossilized birth-death diffusion</a></li><li><a class="tocitem" href="../insane/dbm/">Diffused Brownian motion</a></li><li><a class="tocitem" href="../insane/processing/">Processing</a></li><li><a class="tocitem" href="../insane/iplots/">Plotting</a></li></ul></li><li><a class="tocitem" href="../tribe/">TRIBE</a></li><li class="is-active"><a class="tocitem" href>ESSE</a><ul class="internal"><li><a class="tocitem" href="#Reference"><span>Reference</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Function-Documentation"><span>Function Documentation</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>ESSE</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ESSE</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl/blob/master/docs/src/man/esse.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ESSE"><a class="docs-heading-anchor" href="#ESSE">ESSE</a><a id="ESSE-1"></a><a class="docs-heading-anchor-permalink" href="#ESSE" title="Permalink"></a></h1><h2 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h2><p>Quintero, I., Landis, M. J., Jetz, W., &amp; Morlon, H. (2022). The build-up of the present-day tropical diversity of tetrapods. Proceedings of the National Academy of Sciences, 2023. 120 (20) e2220672120. <a href="https://doi.org/10.1073/pnas.2220672120">https://doi.org/10.1073/pnas.2220672120</a></p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>In this example we run some random data for 50 species across 2 areas, where each area has a specific covariate that affects speciation and we also allow for 2 hidden states.</p><p>Open Julia and load the Tapestree package: </p><pre><code class="language-julia hljs">using Tapestree</code></pre><p>Specify the path to the phylogenetic tree (in a format that <code>ape::read.tree()</code> can read):</p><pre><code class="language-julia hljs">tree_file = joinpath(dirname(pathof(Tapestree)), &quot;..&quot;, &quot;data&quot;, &quot;tree_50.tre&quot;)</code></pre><p>Specify state data. Data should be a <code>.txt</code> file where each row is a species,  first the species name that matches the tree tip labels and each subsequent column specifying presence or absence in a given area with <code>0</code> or <code>1</code>,  respecitvely. Open <code>st2_data.txt</code> in the data folder to see an example for 2 areas.</p><pre><code class="language-julia hljs">states_file = joinpath(dirname(pathof(Tapestree)), &quot;..&quot;, &quot;data&quot;, &quot;st2_data.txt&quot;)</code></pre><p>Specify covariate data <span>$y = f(x)$</span>. Data should be a <code>.txt</code> file where the  first column is time <span>$x$</span> in backward fashion (the present is <span>$0$</span> and the  past is <span>$&gt; 0$</span>), and the subsequent columns are the respective time covariates for each area <span>$f(x)$</span>. If there is only one covariate, the same is used across all areas, if not, the number of covariates should match the specific model.  More than one covariate per area is allowed, and in the case of covariates  affecting colonization rates, they should match the number of possible  colonization parameters between all areas. Open <code>env_data_2.txt</code> in the data folder to see an example for 2 covariates for 2 areas.</p><pre><code class="language-julia hljs">envdata_file = joinpath(dirname(pathof(Tapestree)), &quot;..&quot;, &quot;data&quot;, &quot;env_data_2.txt&quot;)</code></pre><p>Specify output MCMC file (<code>homedir()</code> is an alias to your home folder)</p><pre><code class="language-julia hljs">out_file = *(homedir(),&quot;...&quot;)</code></pre><p>Specify the (optional) output file (<code>homedir()</code> is an alias to your home  folder) for the node marginal probabilities. </p><pre><code class="language-julia hljs">out_states = *(homedir(),&quot;...&quot;)</code></pre><p>Run the <code>esse()</code> (ESSE: Environmental and State dependent Speciation and  Extinction) model, with covariates affecting speciation rates:</p><pre><code class="language-julia hljs">esse(tree_file, out_file, 2, envdata_file = envdata_file, 
  states_file = states_file, out_states = out_states, cov_mod = (&quot;s&quot;,))</code></pre><p>If one would like to make the covariates affect other rates, such as dispersal, in addition to speciation rates, one would specify the following covariate model <code>cov_mod = (&quot;s&quot;,&quot;g&quot;)</code>. Note however that this has not been validated.  Moreover, covariate effect on extinction is non retrievable from extant-only phylogenetic trees.</p><h3 id="Parallel-MC3"><a class="docs-heading-anchor" href="#Parallel-MC3">Parallel MC3</a><a id="Parallel-MC3-1"></a><a class="docs-heading-anchor-permalink" href="#Parallel-MC3" title="Permalink"></a></h3><p>It is encouraged to use Metropolis coupled MCMC (MC3) for more robust  convergence (the posterior surfaced is highly peaked).</p><p>Load the Distributed package, set the number of processors for Julia, and make Tapestree available to all (see the <a href="https://docs.julialang.org/en/v1/stdlib/Distributed/#man-distributed">Distributed</a>  package for more information). Below we add 3 processors.</p><pre><code class="language-julia hljs">using Distributed
addprocs(3)
@everywhere using Tapestree</code></pre><h3 id="Set-parameter-constraints"><a class="docs-heading-anchor" href="#Set-parameter-constraints">Set parameter constraints</a><a id="Set-parameter-constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Set-parameter-constraints" title="Permalink"></a></h3><p>To constrain parameters to be equal to one another or to fix them to be <code>0</code>,  it is necessary to create equalities between parameters and pass them as an  argument. In general parameters are specified as follows:    &quot;&lt;parameter name&gt;_&lt;area&gt;_&lt;hidden state&gt;&quot;</p><ul><li>Speciation is &quot;lambda&quot; (e.g. speciation rate for area A and hidden state 0: <code>lambda_A_0</code>)</li><li>Local extinction is &quot;loss&quot; (e.g. local extinction rate for area B and hidden state 1: <code>loss_B_1</code>)</li><li>colonization is &quot;gain&quot; (e.g. gain rate from A -&gt; B and hidden state 1: <code>gain_AB_1</code>)</li><li>the effect of the covariate is &quot;beta_&lt;effect parameter name&gt;&quot; (e.g. effect of first covariate on speciation in area A and hidden state 0: <code>beta_lambda_1_A_0</code> - here the 1 after the lambda is because is the first covariate)</li><li>transition between hidden states is &quot;q&quot; (e.g. transition rate from hidden state 0 -&gt; 1 and hidden state 1: <code>q_01</code>). </li></ul><p>You have to make sure that the given constraints apply to the specification of  model. In the following example, we constraint local and global extinction rates to be the same across 2 areas and 2 hidden states , and constrain the hidden states transition rates.</p><pre><code class="language-julia hljs">cpar = (&quot;q_01 = q_10&quot;,
        &quot;loss_A_0 = mu_A_0&quot;,
        &quot;loss_B_0 = mu_B_0&quot;,
        &quot;loss_A_1 = mu_A_1&quot;,
        &quot;loss_B_1 = mu_B_1&quot;)</code></pre><p>We now run esse, using MC3 with Metropolis-Hastings MCMC (here using 3 parallel chains).</p><pre><code class="language-julia hljs">esse(tree_file, out_file, 2,
     envdata_file = envdata_file,
     states_file  = states_file, 
     out_states   = out_states,
     constraints  = cpar,
     cov_mod      = (&quot;s&quot;,),
     ncch         = 3,
     parallel     = true,
     niter        = 5_000,
     nthin        = 100,
     dt           = 0.8,
     nburn        = 1_000, 
     mc           = &quot;mh&quot;,
     node_ps      = (true, 100))</code></pre><p>For optional (keyword) arguments, see below</p><h2 id="Function-Documentation"><a class="docs-heading-anchor" href="#Function-Documentation">Function Documentation</a><a id="Function-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Function-Documentation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.ESSE.esse" href="#Tapestree.ESSE.esse"><code>Tapestree.ESSE.esse</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">esse(tree_file   ::String,
     out_file    ::String,
     h           ::Int64;
     states_file ::String            = &quot;NaN&quot;,
     envdata_file::String            = &quot;NaN&quot;,
     cov_mod     ::NTuple{M,String}  = (&quot;&quot;,),
     node_ps     ::Tuple{Bool,Int64} = (true, 10),
     out_states  ::String            = &quot;&quot;,
     constraints ::NTuple{N,String}  = (&quot; &quot;,),
     mvpars      ::NTuple{O,String}  = (&quot; &quot;,),
     niter       ::Int64             = 10_000,
     nthin       ::Int64             = 10,
     nburn       ::Int64             = 200,
     tune_int    ::Int64             = 100,
     nswap       ::Int64             = 10,
     ncch        ::Int64             = 1,
     parallel    ::Bool              = ncch &gt; 1,
     dt           ::Float64          = 0.2,
     ntakew      ::Int64             = 100,
     winit       ::Float64           = 2.0,
     scale_y     ::NTuple{2,Bool}    = (true, false),
     algorithm   ::String            = &quot;pruning&quot;,
     mc          ::String            = &quot;slice&quot;,
     λpriors     ::Float64           = .1,
     μpriors     ::Float64           = .1,
     gpriors     ::Float64           = .1,
     lpriors     ::Float64           = .1,
     qpriors     ::Float64           = .1,
     βpriors     ::NTuple{2,Float64} = (0.0, 10.0),
     hpriors     ::Float64           = .1,
     optimal_w   ::Float64           = 0.8,
     tni         ::Float64           = 1.0,
     obj_ar      ::Float64           = 0.6,
     screen_print::Int64             = 5,
     Eδt         ::Float64           = 1e-3,
     ti          ::Float64           = 0.0,
     ρ           ::Array{Float64,1}  = [1.0]) where {M,N,O}</code></pre><p>Run geographic <strong>esse</strong>. See tutorial for how these files should be specified.</p><p><strong>Arguments</strong></p><ul><li><code>tree_file::String</code>: full path to tree file.</li><li><code>out_file::String</code>: full path to write MCMC output.</li><li><code>h::Int64</code>: number of hidden states.</li><li><code>states_file ::String = &quot;NaN&quot;</code>: full path to states file. If <code>&quot;NaN&quot;</code>, no </li></ul><p>observed states are used (only hidden states).</p><ul><li><code>envdata_file::String = &quot;NaN&quot;</code>: full path to covariates file. If <code>&quot;NaN&quot;</code>, no </li></ul><p>covariates are used (i.e., constant rates).</p><ul><li><code>cov_mod::NTuple{M,String} = (&quot;&quot;,)</code>: specifies which rates are affected by </li></ul><p>covariates: <code>s</code> for speciation, <code>e</code> for extinction, and <code>g</code> for colonization. More than 1 is possible.</p><ul><li><code>node_ps::Tuple{Bool,Int64} = (true, 10)</code>: first index specifies if posterior</li></ul><p>marginal probabilities for nodes should be computed, second index the number of iterations to be computed. </p><ul><li><code>out_states::String = &quot;&quot;</code>: full path to write node probabilities output.</li><li><code>constraints::NTuple{N,String} = (&quot; &quot;,)</code>: constraints for the model </li></ul><p>parameters.</p><ul><li><code>mvpars::NTuple{O,String} = (&quot; &quot;,)</code>: which parameters should be multivariate </li></ul><p>when using slice sampling for better convergence.</p><ul><li><code>niter::Int64 = 10_000</code>: number of iterations.</li><li><code>nthin::Int64 = 10</code>: frequency at which to record MCMC state.</li><li><code>nburn::Int64 = 200</code>: number of iterations to discard as burn-in.</li><li><code>tune_int::Int64 = 100</code>: number of iterations during <code>nburn</code> to tune proposal</li></ul><p>window for MH.</p><ul><li><code>nswap::Int64 = 10</code>: every iteration to try to swap chain likelihoods in MC3.</li><li><code>ncch::Int64 = 1</code>: number of chains.</li><li><code>parallel::Bool = false</code>: if parallel run.</li><li><code>dt::Float64 = 0.2</code>: temperature for MC3.</li><li><code>ntakew::Int64 = 100</code>: number of iterations from <code>nburn</code> to tune the window</li></ul><p>for slice sampling.</p><ul><li><code>winit::Float64 = 2.0</code>: initial window for slice sampling.</li><li><code>scale_y::NTuple{2,Bool} = (true, false)</code>: first index if scale covariates <code>y</code></li></ul><p>to [0,1], second, if scale covariates <code>y</code> all together between [0,1].</p><ul><li><code>algorithm::String = &quot;pruning&quot;</code>: likelihood algorithm between <code>pruning</code> </li></ul><p>(recommended) or <code>flow</code>.</p><ul><li><code>mc::String = &quot;slice&quot;</code>: which sampling <code>slice</code> (slice-sampling) or </li></ul><p><code>mh</code> (metropolis-hasting).</p><ul><li><code>λpriors::Float64 = 0.1</code>: rate of Exponential prior for speciation.</li><li><code>μpriors::Float64 = 0.1</code>: rate of Exponential prior for global extinction.</li><li><code>gpriors::Float64 = 0.1</code>: rate of Exponential prior for colonization.</li><li><code>lpriors::Float64 = 0.1</code>: rate of Exponential prior for local extinction.</li><li><code>qpriors::Float64 = 0.1</code>: rate of Exponential prior for hidden state </li></ul><p>transitions.</p><ul><li><code>βpriors::NTuple{2,Float64} = (0.0, 10.0)</code>: mean and variance of Normal </li></ul><p>prior for effect of covariates.</p><ul><li><code>hpriors::Float64 = 0.1</code>: rate of Exponential prior for differences between</li></ul><p>hidden states.</p><ul><li><code>optimal_w::Float64 = 0.8</code>: optimal window.</li><li><code>tni::Float64 = 1.0</code>: initial tuning for rates.</li><li><code>obj_ar::Float64 = 0.23</code>: objective acceptance rate.</li><li><code>screen_print::Int64 = 5</code>: seconds to wait to update screen log.</li><li><code>Eδt::Float64 = 1e-3</code>: for flow algorithm.</li><li><code>ti::Float64 = 0.0</code>: for flow algorithm.</li><li><code>ρ::Array{Float64,1} = [1.0]</code>: sampling fraction for each state (each area and</li></ul><p>widespread).</p><p><strong>Returned values</strong></p><ul><li>Array of the mcmc parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/esse/sse_wrapper.jl#L16-L116">source</a></section><section><div><pre><code class="language-julia hljs">esse(tv          ::Dict{Int64,Array{Float64,1}},
     ed          ::Array{Int64,2}, 
     el          ::Array{Float64,1}, 
     x           ::Array{Float64,1},
     y           ::Array{Float64,L}, 
     cov_mod     ::NTuple{M,String},
     out_file    ::String,
     h           ::Int64;
     constraints ::NTuple{N,String}  = (&quot; &quot;,),
     mvpars      ::NTuple{O,String}  = (&quot;lambda = beta&quot;,),
     niter       ::Int64             = 10_000,
     nthin       ::Int64             = 10,
     nburn       ::Int64             = 200,
     ncch        ::Int64             = 1,
     ntakew      ::Int64             = 100,
     winit       ::Float64             = 2.0,
     scale_y     ::NTuple{2,Bool}    = (true, false),
     algorithm   ::String            = &quot;pruning&quot;,
     λpriors     ::Float64           = .1,
     μpriors     ::Float64           = .1,
     gpriors     ::Float64           = .1,
     lpriors     ::Float64           = .1,
     qpriors     ::Float64           = .1,
     βpriors     ::NTuple{2,Float64} = (0.0, 10.0),
     hpriors     ::Float64           = .1,
     optimal_w   ::Float64           = 0.8,
     screen_print::Int64             = 5,
     Eδt         ::Float64           = 1e-3,
     ti          ::Float64           = 0.0,
     ρ           ::Array{Float64,1}  = [1.0]) where {L,M,N,O}</code></pre><p>Wrapper for running a <strong>esse</strong> model from simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/esse/sse_wrapper.jl#L311-L344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Tapestree.ESSE.simulate_sse" href="#Tapestree.ESSE.simulate_sse"><code>Tapestree.ESSE.simulate_sse</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_sse(λ          ::Array{Float64,1},
             μ          ::Array{Float64,1},
             l          ::Array{Float64,1},
             g          ::Array{Float64,1},
             q          ::Array{Float64,1},
             t          ::Float64;
             δt         ::Float64 = 1e-4,
             ast        ::Int64   = 0,
             nspp_max   ::Int64   = 100_000,
             retry_ext  ::Bool    = true,
             rejectel0  ::Bool    = true,
             verbose    ::Bool    = true,
             rm_ext     ::Bool    = true,
             states_only::Bool    = false, 
             start      ::Symbol  = :crown)</code></pre><p>Simulate tree according to the geographic <strong>esse</strong> model. The number of areas  and hidden states is inferred from the parameter vectors, but they must be  consistent between them and with the covariates. See tutorial for an example.</p><p><strong>Arguments</strong></p><ul><li><code>λ::Array{Float64,1}</code>: rates for within-area and between-area speciation.</li><li><code>μ::Array{Float64,1}</code>: per-area extinction rates when it leads to global </li></ul><p>extinction.</p><ul><li><code>l::Array{Float64,1}</code>: per-area extinction rates when it leads to local </li></ul><p>extinction.</p><ul><li><code>g::Array{Float64,1}</code>: colonization rates between areas. </li><li><code>q::Array{Float64,1}</code>: transition rates between hidden states.</li><li><code>t::Float64</code>: simulation time.</li><li><code>δt::Float64 = 1e-4</code>: time step to perform simulations. Smaller more precise </li></ul><p>but more computationally expensive.</p><ul><li><code>ast::Int64 = 0</code>: initial state. <code>0</code> specifies random sampling based on the </li></ul><p>input parameters.</p><ul><li><code>nspp_max::Int64 = 100_000</code>: maximum number of species allowed to stop </li></ul><p>simulation.</p><ul><li><code>retry_ext::Bool = true</code>: automatically restart simulation if simulation goes</li></ul><p>extinct.</p><ul><li><code>rejectel0::Bool = true</code>: reject simulations where there are edges of 0 </li></ul><p>length.</p><ul><li><code>verbose::Bool = true</code>: print messages.</li><li><code>rm_ext::Bool = true</code>: remove extinct taxa from output.</li><li><code>states_only::Bool = false</code>: if only return tip states (faster).</li><li><code>start::Symbol  = :crown</code>: if <code>crown</code>, starts after a speciation event with </li></ul><p>two lineages, if <code>stem</code>, starts with one lineage.</p><p><strong>Returned values</strong></p><ul><li>Dictionary with tip number and corresponding state.</li><li>Array with parent -&gt; daughter edges.</li><li>Array with edge lengths.</li><li>Number of maximum species.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/esse/simulate_sse_g.jl#L14-L66">source</a></section><section><div><pre><code class="language-julia hljs">simulate_sse(λ          ::Array{Float64,1},
             μ          ::Array{Float64,1},
             l          ::Array{Float64,1},
             g          ::Array{Float64,1},
             q          ::Array{Float64,1},
             β          ::Array{Float64,1},
             t          ::Float64,
             x          ::Array{Float64,1},
             y          ::Array{Float64,N},
             cov_mod    ::Tuple{Vararg{String}};
             δt         ::Float64 = 1e-4,
             ast        ::Int64   = 0,
             nspp_max   ::Int64   = 100_000,
             retry_ext  ::Bool    = true,
             rejectel0  ::Bool    = true,
             verbose    ::Bool    = true,
             rm_ext     ::Bool    = true,
             states_only::Bool    = false,
             start      ::Symbol  = :crown) where {N}</code></pre><p>Simulate tree according to the geographic <strong>sse</strong> model. The number of areas  and hidden states is inferred from the parameter vectors, but they must be  consistent between them and with the covariates. See tutorial for an example.</p><p><strong>Arguments</strong></p><ul><li><code>λ::Array{Float64,1}</code>: rates for within-area and between-area speciation.</li><li><code>μ::Array{Float64,1}</code>: per-area extinction rates when it leads to global </li></ul><p>extinction.</p><ul><li><code>l::Array{Float64,1}</code>: per-area extinction rates when it leads to local </li></ul><p>extinction.</p><ul><li><code>g::Array{Float64,1}</code>: colonization rates between areas. </li><li><code>q::Array{Float64,1}</code>: transition rates between hidden states.</li><li><code>β::Array{Float64,1}</code>: per-area effect of covariates.</li><li><code>t::Float64</code>: simulation time.</li><li><code>x::Array{Float64,1}</code>: times where the covariate <code>y</code> is sampled.</li><li><code>y::Array{Float64,N}</code>: value of covariates, i.e., <code>f(x)</code>. Can be multivariate.</li><li><code>cov_mod::Tuple{Vararg{String}}</code>: specifies which rates are affected by </li></ul><p>covariates: <code>s</code> for speciation, <code>e</code> for extinction, and <code>g</code> for colonization. More than 1 is possible. </p><ul><li><code>δt::Float64 = 1e-4</code>: time step to perform simulations. Smaller more precise </li></ul><p>but more computationally expensive.</p><ul><li><code>ast::Int64 = 0</code>: initial state. <code>0</code> specifies random sampling based on the </li></ul><p>input parameters.</p><ul><li><code>nspp_max::Int64 = 100_000</code>: maximum number of species allowed to stop </li></ul><p>simulation.</p><ul><li><code>retry_ext::Bool = true</code>: automatically restart simulation if simulation goes</li></ul><p>extinct.</p><ul><li><code>rejectel0::Bool = true</code>: reject simulations where there are edges of 0 </li></ul><p>length.</p><ul><li><code>verbose::Bool = true</code>: print messages.</li><li><code>rm_ext::Bool = true</code>: remove extinct taxa from output.</li><li><code>states_only::Bool = false</code>: if only return tip states (faster).</li><li><code>start::Symbol  = :crown</code>: if <code>crown</code>, starts after a speciation event with </li></ul><p>two lineages, if <code>stem</code>, starts with one lineage.</p><p><strong>Returned values</strong></p><ul><li>Dictionary with tip number and corresponding state.</li><li>Array with parent -&gt; daughter edges.</li><li>Array with edge lengths.</li><li>Number of maximum species.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ignacioq/Tapestree.jl/blob/881c36932792d24b15cd2c6dd75e3bb646d273e0/src/esse/simulate_esse_g.jl#L14-L76">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tribe/">« TRIBE</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.2 on <span class="colophon-date" title="Thursday 15 May 2025 12:22">Thursday 15 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
