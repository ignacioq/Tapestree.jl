<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Plotting · Tapestree.jl</title><meta name="title" content="Plotting · Tapestree.jl"/><meta property="og:title" content="Plotting · Tapestree.jl"/><meta property="twitter:title" content="Plotting · Tapestree.jl"/><meta name="description" content="Documentation for Tapestree.jl."/><meta property="og:description" content="Documentation for Tapestree.jl."/><meta property="twitter:description" content="Documentation for Tapestree.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.png" alt="Tapestree.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.png" alt="Tapestree.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../installation/">Installation</a></li><li><a class="tocitem" href="../../../quick_start/">Quick start</a></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">INSANE</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../contents/">Contents</a></li><li><a class="tocitem" href="../io/">Input and structures</a></li><li><a class="tocitem" href="../cbd/">Constant birth-death</a></li><li><a class="tocitem" href="../bdd/">Birth-death diffusion</a></li><li><a class="tocitem" href="../cfbd/">Constant fossilized birth-death</a></li><li><a class="tocitem" href="../fbdd/">Fossilized birth-death diffusion</a></li><li><a class="tocitem" href="../dbm/">Diffused Brownian motion</a></li><li><a class="tocitem" href="../processing/">Processing</a></li><li class="is-active"><a class="tocitem" href>Plotting</a><ul class="internal"><li><a class="tocitem" href="#Insane-plots-across-all-tree-types"><span>Insane plots across all tree types</span></a></li><li><a class="tocitem" href="#Insane-plots-for-trees-with-diffusion"><span>Insane plots for trees with diffusion</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../tribe/">TRIBE</a></li><li><a class="tocitem" href="../../esse/">ESSE</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li><a class="is-disabled">INSANE</a></li><li class="is-active"><a href>Plotting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Plotting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ignacioq/Tapestree.jl/blob/master/docs/src/man/insane/iplots.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Insane-plots"><a class="docs-heading-anchor" href="#Insane-plots">Insane plots</a><a id="Insane-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-plots" title="Permalink"></a></h1><p>Insane holds recipes to plot phylogenetic trees, results and perform aggregating functions. The output will rely in the number and type of arguments you provide.</p><p>First, however, we need to load the <code>Plots</code> package</p><pre><code class="language-julia hljs">using Plots</code></pre><h2 id="Insane-plots-across-all-tree-types"><a class="docs-heading-anchor" href="#Insane-plots-across-all-tree-types">Insane plots across all tree types</a><a id="Insane-plots-across-all-tree-types-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-plots-across-all-tree-types" title="Permalink"></a></h2><h3 id="Simple-tree-plot"><a class="docs-heading-anchor" href="#Simple-tree-plot">Simple tree plot</a><a id="Simple-tree-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-tree-plot" title="Permalink"></a></h3><p>The most basic plot function simply plots the tree:</p><pre><code class="language-julia hljs">plot(tree)</code></pre><p><img src="../../../assets/img/iplot/pf1.png" alt="pf1"/></p><p>One can reorder the tree according to balance (have one daughter always have the largest number of tips) by using <code>reorder!(tree)</code>, which orders in place the tree and helps in visualization.</p><p>If one has a tree vector, we could, for example, sample <span>$4$</span> of them at random and simply plot them together using</p><pre><code class="language-julia hljs">ti = rand(tv,4)

p0 = plot(ti[1])
p1 = plot(ti[2])
p2 = plot(ti[3])
p3 = plot(ti[4])

plot(p0, p1, p2, p3)</code></pre><p><img src="../../../assets/img/iplot/pf2.png" alt="pf2"/></p><p>If the tree is of type <code>sT_label</code> or <code>sTf_label</code>, labels will be shown automatically, but you can toggle this off with <code>showlabels = false</code>.</p><p>One can also plot the tree radially (as a fan) using</p><pre><code class="language-julia hljs">plot(tree, type = :radial)</code></pre><p><img src="../../../assets/img/iplot/pf3.png" alt="pf3"/></p><p>For trees with fossils the fossilization events are shown as default, but one can change this. For instance, one can also add symbols in the plot for speciation and extinction events beside fossilization events. This can be set by the <code>shownodes</code> keyword, which receives a Boolean Tuple of size <code>3</code>, specifying, if speciation, extinction and fossil events should be shown, respectively. In the same order, with the keyword <code>shapes</code> you specify a vector of <code>Symbol</code>s with the shape (<em>e.g.</em>, <code>:circle</code>), and, finally the keyword <code>colors</code>, in the same order, specifies the colors for each shape.</p><pre><code class="language-julia hljs">plot(tree, shownodes = (true, true, true), 
           shapes = [:circle, :circle, :square],
           shsizes = [3.0, 3.0, 3.0])</code></pre><p><img src="../../../assets/img/iplot/pf4.png" alt="pf4"/></p><h3 id="LTT-and-DTT-plots"><a class="docs-heading-anchor" href="#LTT-and-DTT-plots">LTT and DTT plots</a><a id="LTT-and-DTT-plots-1"></a><a class="docs-heading-anchor-permalink" href="#LTT-and-DTT-plots" title="Permalink"></a></h3><p>We can plot the LTT or DTT by using the <code>ltt</code> result (of type <code>Ltt</code>, check (check <a href="../processing/#Basic-tree-information"> Basic tree information</a>)) as input:</p><pre><code class="language-julia hljs">plot(ltt(tree), linewidth = 2.0)</code></pre><p><img src="../../../assets/img/iplot/pf5.png" alt="pf5"/></p><p>Moreover, if we input a vector of <code>Ltt</code> we will plot each LTT individually, or, better, if we add a decimal number argument, it will use it as sampling frequency through time and return the mean and desired quantiles of lineage or diversity through time using the arguments <code>q0</code> and <code>q1</code> (by default <code>q0 = [0.025, 0.975]</code> and <code>q1 = [0.25, 0.75]</code>):</p><pre><code class="language-julia hljs">lttv = ltt(tv)
plot(lttv, 0.1)</code></pre><p><img src="../../../assets/img/iplot/pf6.png" alt="pf6"/></p><h2 id="Insane-plots-for-trees-with-diffusion"><a class="docs-heading-anchor" href="#Insane-plots-for-trees-with-diffusion">Insane plots for trees with diffusion</a><a id="Insane-plots-for-trees-with-diffusion-1"></a><a class="docs-heading-anchor-permalink" href="#Insane-plots-for-trees-with-diffusion" title="Permalink"></a></h2><p>These plotting functions are specific to BDD, FBDD or DBM type trees (<em>i.e.</em>, of <code>iT</code> or <code>sTxs</code> supertype).</p><h3 id="Plot-the-rates-on-the-tree"><a class="docs-heading-anchor" href="#Plot-the-rates-on-the-tree">Plot the rates on the tree</a><a id="Plot-the-rates-on-the-tree-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-rates-on-the-tree" title="Permalink"></a></h3><p>To &quot;paint&quot; the tree with the instantaneous lineage-specific rates of speciation <span>$\lambda(t)$</span>, we can use:</p><pre><code class="language-julia hljs">plot(tree, birth)</code></pre><p><img src="../../../assets/img/iplot/pf7.png" alt="pf7"/></p><div class="admonition is-info" id="Info-af9163ab9abca09b"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-af9163ab9abca09b" title="Permalink"></a></header><div class="admonition-body"><p><code>birth</code>, which stands for &quot;birth rates&quot;, is a convenience wrapper around <code>exp.(lλ(tree))</code>: it extracts the log-speciation vector from a give <code>iT</code> tree using <code>lλ</code>, and then returns the exponential.</p></div></div><p>This plotting function also allows to plot the death rates (only where extinction is also a diffusion, <em>i.e.</em>, <code>iTbd</code>) using</p><pre><code class="language-julia hljs">plot(tree, death)</code></pre><p><img src="../../../assets/img/iplot/pf8.png" alt="pf8"/> where <code>death</code>, which stands for &quot;death rates&quot; (<em>i.e.</em>, extinction) is a wrapper around <code>exp.(lμ(tree))</code>.</p><p>In general, this plotting recipe receives a tree and a function that is applied recursively to paint the tree. Thus, we can use any custom made function that extracts information from the tree. Some predefined ones are:</p><ul><li><code>logbirth</code>: log-(speciation) birth rates</li><li><code>logdeath</code>: log-(extinction) death rates </li><li><code>turnover</code>: turnover (extinction/speciation) rates</li><li><code>diversification</code>: net diversification (speciation - extinction) rates</li><li><code>trait</code>: trait values</li><li><code>evorate</code>: evolutionary rates <span>$\sigma^2(t)$</span></li><li><code>logevorate</code>: log-evolutionary rates <span>$\sigma^2(t)$</span></li></ul><div class="admonition is-info" id="Info-66b2830dd07fe14d"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-66b2830dd07fe14d" title="Permalink"></a></header><div class="admonition-body"><p>One can also plot these trees radially using the <code>type = :radial</code>.</p></div></div><h4 id="Plot-the-underlying-rates-along-a-tree"><a class="docs-heading-anchor" href="#Plot-the-underlying-rates-along-a-tree">Plot the underlying rates along a tree</a><a id="Plot-the-underlying-rates-along-a-tree-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-underlying-rates-along-a-tree" title="Permalink"></a></h4><p>To plot how rates evolve across time, that is, to plot the rates in the y axis, one simply changes the argument order:</p><pre><code class="language-julia hljs">plot(birth, tree)</code></pre><p><img src="../../../assets/img/iplot/pf9.png" alt="pf9"/></p><p>One can paint these rates by another variable, say, extinction rates, using</p><pre><code class="language-julia hljs">plot(birth, tree, zf = death)</code></pre><p><img src="../../../assets/img/iplot/pf10.png" alt="pf10"/></p><p>Similarly, one can plot the average for a tree (or other aggregating function as median, geometric mean, <em>etc.</em>) and custom quantiles (as in <a href="#LTT-and-DTT-plots">LTT and DTT plots</a>) for a given tree by adding a decimal number argument representing the sampling frequency through time.</p><pre><code class="language-julia hljs">plot(birth, 0.1, tree)</code></pre><p><img src="../../../assets/img/iplot/pf11.png" alt="pf11"/></p><p>To change the aggregating function, one can modify the function <code>t_af</code> (by default <code>t_af = mean</code>), to the desired one.</p><h4 id="Plot-the-rates-across-tree-vectors"><a class="docs-heading-anchor" href="#Plot-the-rates-across-tree-vectors">Plot the rates across tree vectors</a><a id="Plot-the-rates-across-tree-vectors-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-rates-across-tree-vectors" title="Permalink"></a></h4><p>Often one would like to plot the average rates across a series of data augmented trees. This can be done by adding a decimal number argument (and, using a tree vector as input). For instance, to estimate average speciation rates (using wrapping function <code>birth</code>) through time across tree vector <code>tv</code>, every <span>$0.1$</span> time units, we use:</p><pre><code class="language-julia hljs">plot(birth, 0.1, tv)</code></pre><p><img src="../../../assets/img/iplot/pf12.png" alt="pf12"/></p><p>One can choose the function to aggregate rates across lineages for each single tree using <code>af</code> (by default <code>af = mean</code>, and then to aggregate these tree averages using the <code>vaf</code> function (by default <code>vaf = x -&gt; quantile(x, 0.5)</code>, that is, the median).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../processing/">« Processing</a><a class="docs-footer-nextpage" href="../../tribe/">TRIBE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.2 on <span class="colophon-date" title="Wednesday 14 May 2025 15:10">Wednesday 14 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
